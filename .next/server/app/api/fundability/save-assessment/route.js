(()=>{var e={};e.id=913,e.ids=[913],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},39032:(e,s,t)=>{"use strict";t.r(s),t.d(s,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p});var r={};t.r(r),t.d(r,{POST:()=>l});var a=t(49303),o=t(88716),n=t(60670),i=t(87070);let u=(0,t(72438).eI)("https://fzvtzzzsoccptvgihxfl.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function l(e){try{console.log("\uD83C\uDFAF Assessment API called");let{responses:s,currentScore:t,categoryScores:r}=await e.json();if(console.log("\uD83D\uDCCA Received data:",{currentScore:t,categoryScoresCount:Object.keys(r||{}).length,responsesCount:Object.keys(s||{}).length}),"number"!=typeof t)throw Error("Invalid score provided");let a=crypto.randomUUID();console.log("\uD83D\uDC64 Generated user ID:",a);let o={user_id:a,overall_score:t,category_scores:r||{},completion_percentage:100,status:"completed",assessment_version:"2.0",time_to_complete:5,recommendations:[],improvement_areas:[],strengths:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("\uD83D\uDCBE Attempting to save assessment...");let{data:n,error:l}=await u.from("advanced_fundability_assessments").insert([o]).select().single();if(l)return console.error("❌ Assessment save error:",l),i.NextResponse.json({success:!0,fallback:!0,message:"Assessment saved to local storage (database temporarily unavailable)",error:l.message});console.log("✅ Assessment saved with ID:",n.id);let c={id:a,email:"demo@ybwfunds.com",name:"Demo User",business_name:"Demo Business",fundability_score:t,last_assessment_date:new Date().toISOString(),assessment_count:1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:d,error:p}=await u.from("user_profiles").upsert(c).select().single();return p?console.warn("⚠️ Profile save warning:",p):console.log("✅ User profile saved/updated"),i.NextResponse.json({success:!0,data:{assessment:n,profile:d,userId:a},message:"Assessment saved successfully to database!"})}catch(e){return console.error("❌ API Error:",e),i.NextResponse.json({success:!0,fallback:!0,message:"Assessment saved locally (will sync when database is available)",details:e instanceof Error?e.message:"Unknown error"})}}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/fundability/save-assessment/route",pathname:"/api/fundability/save-assessment",filename:"route",bundlePath:"app/api/fundability/save-assessment/route"},resolvedPagePath:"C:\\Users\\dondr\\ybw-funds-platform\\ybw-funds-platform\\src\\app\\api\\fundability\\save-assessment\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:m}=c,g="/api/fundability/save-assessment/route";function v(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,169],()=>t(39032));module.exports=r})();