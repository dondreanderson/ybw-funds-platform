exports.id=929,exports.ids=[929],exports.modules={58359:()=>{},93739:()=>{},73143:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},17545:(e,r,t)=>{Promise.resolve().then(t.bind(t,42126))},42126:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var s=t(10326),a=t(77109);function n({children:e}){return s.jsx(a.SessionProvider,{children:e})}},63292:(e,r,t)=>{"use strict";t.d(r,{WB:()=>o,KD:()=>a,UI:()=>c}),t(17577);let s=(0,t(52997).eI)("https://fzvtzzzsoccptvgihxfl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ6dnR6enpzb2NjcHR2Z2loeGZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExNTAwNjksImV4cCI6MjA2NjcyNjA2OX0.UFY3vSerY963T2cqbgrhstgZfhkgfN5KN7lZUVZ8DLA");class a{static async getCurrentUserProfile(){try{let{data:{user:e},error:r}=await s.auth.getUser();if(r||!e)return{data:null,error:Error("No authenticated user")};let{data:t,error:a}=await s.from("user_profiles").select(`
          *,
          business_profiles (*)
        `).eq("id",e.id).single();if(t&&t.business_profiles&&Array.isArray(t.business_profiles))return{data:{...t,business_profile:t.business_profiles[0]||null},error:null};return{data:t,error:a}}catch(e){return{data:null,error:e}}}static async getUserProfile(e){try{let{data:r,error:t}=await s.from("user_profiles").select("*").eq("id",e).single();return{data:r,error:t}}catch(e){return{data:null,error:e}}}static async updateUserProfile(e,r){try{let{data:t,error:a}=await s.from("user_profiles").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();return{data:t,error:a}}catch(e){return{data:null,error:e}}}static async upsertBusinessProfile(e,r){try{let{data:t,error:a}=await s.from("business_profiles").upsert({user_id:e,...r,updated_at:new Date().toISOString()}).select().single();return{data:t,error:a}}catch(e){return{data:null,error:e}}}static async updateFundabilityScore(e,r){try{let{data:t,error:a}=await s.from("user_profiles").update({fundability_score:r,last_assessment_date:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).select().single();return{data:t,error:a}}catch(e){return{data:null,error:e}}}static async incrementAssessmentCount(e){try{let{data:r,error:t}=await s.rpc("increment_assessment_count",{user_id:e});if(t){let{data:r}=await this.getUserProfile(e);if(r)return await this.updateUserProfile(e,{assessment_count:(r.assessment_count||0)+1})}return{data:r,error:t}}catch(e){return{data:null,error:e}}}}class n{static{this.CATEGORY_WEIGHTS={"Business Foundation":1.2,"Legal Structure":1.1,"Banking & Finance":1.3,"Business Credit Profile":1.4,"Marketing Presence":1,"Operational Excellence":1,Documentation:1.1,"Financial Health":1.2}}static calculateAssessmentScore(e){try{let r=this.groupResponsesByCategory(e),t=[],s=0,a=0,n=0,o=e.length;for(let[e,o]of Object.entries(r)){let r=this.calculateCategoryScore(e,o);t.push(r),s+=r.weightedScore,a+=r.maxScore*r.weight,n+=r.completedCriteria}let i=a>0?s/a*100:0,c=o>0?n/o*100:0,l=this.generateRecommendations(t),u=this.identifyImprovementAreas(t),d=this.identifyStrengths(t);return{overallScore:Math.round(i),maxPossibleScore:Math.round(a),percentageScore:Math.round(100*i)/100,categoryScores:t,completedCriteria:n,totalCriteria:o,completionPercentage:Math.round(100*c)/100,recommendations:l,improvementAreas:u,strengths:d}}catch(e){throw console.error("Error calculating assessment score:",e),e}}static async saveAssessment(e,r){try{let t=r.categoryScores.reduce((e,r)=>(e[r.category]=r.score,e),{}),{data:a,error:n}=await s.from("advanced_fundability_assessments").insert({user_id:e,overall_score:r.overallScore,category_scores:t,completion_percentage:r.completionPercentage,recommendations:r.recommendations,improvement_areas:r.improvementAreas,strengths:r.strengths,status:"completed",assessment_version:"2.0"}).select().single();return!n&&a&&await this.saveScoreHistory(e,a.id,r),{data:a,error:n}}catch(e){return{data:null,error:e}}}static async saveScoreHistory(e,r,t){try{let{data:a}=await s.from("score_history").select("overall_score").eq("user_id",e).order("created_at",{ascending:!1}).limit(1).single(),n=a?t.overallScore-a.overall_score:0,o=t.categoryScores.reduce((e,r)=>(e[r.category]=r.score,e),{}),{data:i,error:c}=await s.from("score_history").insert({user_id:e,assessment_id:r,overall_score:t.overallScore,category_scores:o,assessment_date:new Date().toISOString().split("T")[0],score_change:n}).select().single();return{data:i,error:c}}catch(e){return{data:null,error:e}}}static groupResponsesByCategory(e){return e.reduce((e,r)=>{let t=r.category;return e[t]||(e[t]=[]),e[t].push(r),e},{})}static calculateCategoryScore(e,r){let t=0,s=0,a=0,n=r.length,o=this.CATEGORY_WEIGHTS[e]||1;r.forEach(e=>{let r=e.weightFactor||1;s+=e.pointsPossible*r,null!==e.responseValue&&void 0!==e.responseValue&&(a++,t+=e.pointsEarned*r)});let i=s>0?t/s*100:0,c=t*o;return{category:e,score:Math.round(t),maxScore:Math.round(s),percentage:Math.round(100*i)/100,weight:o,weightedScore:Math.round(c),completedCriteria:a,totalCriteria:n}}static generateRecommendations(e){let r=[];return e.filter(e=>e.percentage<80).sort((e,r)=>e.percentage-r.percentage).slice(0,5).forEach(e=>{r.push(this.getCategoryRecommendation(e.category,e.percentage))}),r}static identifyImprovementAreas(e){return e.filter(e=>e.percentage<70).sort((e,r)=>e.percentage-r.percentage).map(e=>e.category)}static identifyStrengths(e){return e.filter(e=>e.percentage>=85).sort((e,r)=>r.percentage-e.percentage).map(e=>e.category)}static getCategoryRecommendation(e,r){let t=r<50?"immediately":r<70?"soon":"when possible";return({"Business Foundation":`Strengthen your business foundation ${t}. Focus on completing business registration and establishing core business infrastructure.`,"Legal Structure":`Improve your legal structure ${t}. Ensure all business licenses and legal documentation are current and complete.`,"Banking & Finance":`Enhance your banking relationships ${t}. Consider opening dedicated business accounts and establishing banking relationships.`,"Business Credit Profile":`Build your business credit profile ${t}. Apply for business credit accounts and monitor your business credit reports.`,"Marketing Presence":`Develop your marketing presence ${t}. Create professional online presence and marketing materials.`,"Operational Excellence":`Improve operational systems ${t}. Implement business processes and operational procedures.`,Documentation:`Complete business documentation ${t}. Organize and maintain all required business documents.`,"Financial Health":`Strengthen financial health ${t}. Focus on improving cash flow and financial management practices.`})[e]||`Improve ${e.toLowerCase()} ${t} to increase your fundability score.`}}class o{static async getAssessmentHistory(e,r={}){try{let{limit:t=10,offset:a=0}=r,{data:n,error:o,count:i}=await s.from("advanced_fundability_assessments").select("*",{count:"exact"}).eq("user_id",e).order("created_at",{ascending:!1}).range(a,a+t-1);return{data:n,error:o,count:i||0}}catch(e){return{data:null,error:e}}}static async getLatestAssessment(e){try{let{data:r,error:t}=await s.from("advanced_fundability_assessments").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(1).single();return{data:r,error:t}}catch(e){return{data:null,error:e}}}static async getScoreTrend(e,r=30){try{let t=new Date;t.setDate(t.getDate()-r);let{data:a,error:n}=await s.from("score_history").select("*").eq("user_id",e).gte("assessment_date",t.toISOString().split("T")[0]).order("assessment_date",{ascending:!0});return{data:a,error:n}}catch(e){return{data:null,error:e}}}static async getAssessmentRecommendations(e){try{let{data:r,error:t}=await s.from("assessment_recommendations").select("*").eq("assessment_id",e).order("priority",{ascending:!1}).order("estimated_impact_points",{ascending:!1});return{data:r,error:t}}catch(e){return{data:null,error:e}}}static async detailedHealthCheck(){let e={connected:!1,tablesAccessible:[],errors:[]};for(let r of["users","user_profiles","advanced_fundability_assessments","score_history","business_profiles"])try{let{error:t}=await s.from(r).select("id").limit(1);t?e.errors.push(`${r}: ${t.message}`):e.tablesAccessible.push(r)}catch(t){e.errors.push(`${r}: ${t}`)}return e.connected=e.tablesAccessible.length>0,e}}class i{async getLatestAssessment(e){try{console.log("Fetching assessment for user:",e);let r=new Promise((e,r)=>setTimeout(()=>r(Error("Query timeout")),1e4)),t=s.from("advanced_fundability_assessments").select(`
          *,
          category_performances (*)
        `).eq("user_id",e).order("created_at",{ascending:!1}).limit(1).single(),{data:a,error:n}=await Promise.race([t,r]);if(n||!a)return console.log("No assessment found or error:",n?.message),this.getFallbackAssessment(e);return console.log("Assessment found:",a),a}catch(r){return console.error("Error fetching assessment:",r),this.getFallbackAssessment(e)}}async getAssessmentHistory(e){try{console.log("Fetching history for user:",e);let r=await this.getLatestAssessment(e);return r?[r]:[]}catch(e){return console.error("Error fetching history:",e),[]}}async getScoreHistory(e){try{return console.log("Fetching score history for user:",e),this.generateMockHistory(e)}catch(r){return console.error("Error fetching score history:",r),this.generateMockHistory(e)}}async saveAssessment(e,r,t,a){try{console.log("Saving assessment for user:",e);let{data:n,error:o}=await s.from("advanced_fundability_assessments").insert({user_id:e,overall_score:r,category_scores:t,completion_percentage:100,status:"completed",assessment_version:"2.0"}).select().single();if(o)return console.error("Error saving assessment:",o),null;if(a&&a.length>0){let e=a.map(e=>({assessment_id:n.id,category_name:e.categoryName,score:e.score,max_score:e.maxScore,completed_criteria:e.completedCriteria,total_criteria:e.totalCriteria})),{error:r}=await s.from("category_performances").insert(e);r&&console.error("Error saving category performances:",r)}let{error:i}=await s.from("score_history").insert({user_id:e,assessment_id:n.id,overall_score:r,category_scores:t,assessment_date:new Date().toDateString(),score_change:0});return i&&console.error("Error saving score history:",i),console.log("Assessment saved successfully:",n.id),n.id}catch(e){return console.error("Error in saveAssessment:",e),null}}getFallbackAssessment(e){let r={"admin@ybwfunds.com":95,"enterprise@ybwfunds.com":90,"business@ybwfunds.com":85,"demo@ybwfunds.com":75,"startup@ybwfunds.com":65,"lowscore@ybwfunds.com":25}[e]||82;return{id:`fallback-${e}`,user_id:e,overall_score:r,category_scores:this.generateCategoryScores(r),created_at:new Date().toISOString(),completion_percentage:100,assessment_version:"2.0",status:"completed",category_performances:[{id:"1",category_name:"Business Registration",score:Math.max(30,r-10+20*Math.random()),max_score:100,completed_criteria:18,total_criteria:20},{id:"2",category_name:"Credit Profile",score:Math.max(30,r-5+15*Math.random()),max_score:100,completed_criteria:19,total_criteria:20},{id:"3",category_name:"Financial Documentation",score:Math.max(30,r+10*Math.random()),max_score:100,completed_criteria:17,total_criteria:20},{id:"4",category_name:"Operational Infrastructure",score:Math.max(30,r-15+25*Math.random()),max_score:100,completed_criteria:16,total_criteria:20},{id:"5",category_name:"Online Presence",score:Math.max(30,r-20+30*Math.random()),max_score:100,completed_criteria:15,total_criteria:20},{id:"6",category_name:"Risk & Compliance",score:Math.max(30,r-8+18*Math.random()),max_score:100,completed_criteria:19,total_criteria:20}]}}generateCategoryScores(e){let r={};return["business_registration","credit_profile","financial_documentation","operational_infrastructure","online_presence","risk_compliance"].forEach(t=>{r[t]=Math.max(0,Math.min(100,Math.round(e+(Math.random()-.5)*30)))}),r}generateMockHistory(e){let r=Math.max(20,({"admin@ybwfunds.com":95,"enterprise@ybwfunds.com":90,"business@ybwfunds.com":85,"demo@ybwfunds.com":75,"startup@ybwfunds.com":65,"lowscore@ybwfunds.com":25}[e]||82)-20);return["2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01"].map((e,t)=>({id:`history_${t}`,overall_score:Math.round(r+4*t),assessment_date:e,category_scores:{}}))}transformToChartData(e){if(console.log("Transforming chart data:",e),!e||!e.category_performances)return{categoryData:[],overallScore:0,metrics:[]};let r=e.category_performances.map(e=>({category:e.category_name,score:Math.round(e.score),fullMark:e.max_score,benchmark:this.getIndustryBenchmark(e.category_name)})),t=e.category_performances.map(e=>({title:e.category_name,value:Math.round(e.score),change:Math.floor(20*Math.random())-10,color:this.getCategoryColor(e.category_name)}));return{categoryData:r,overallScore:e.overall_score,metrics:t}}transformToTrendData(e){return e.map((e,r)=>({date:new Date(e.assessment_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),score:e.overall_score}))}transformToComparisonData(e){return e&&e.category_performances?e.category_performances.map(e=>({category:e.category_name,score:Math.round(e.score),benchmark:this.getIndustryBenchmark(e.category_name),fullMark:e.max_score})):[]}getIndustryBenchmark(e){return({"Business Registration":75,"Credit Profile":80,"Financial Documentation":85,"Operational Infrastructure":78,"Online Presence":72,"Risk & Compliance":80})[e]||75}getCategoryColor(e){return({"Business Registration":"#10b981","Credit Profile":"#3b82f6","Financial Documentation":"#8b5cf6","Operational Infrastructure":"#f59e0b","Online Presence":"#ef4444","Risk & Compliance":"#06b6d4"})[e]||"#6b7280"}}let c=new i},15495:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c,metadata:()=>i});var s=t(19510),a=t(25384),n=t.n(a);t(5023);let o=(0,t(68570).createProxy)(String.raw`C:\Users\dondr\ybw-funds-platform\ybw-funds-platform\src\app\providers.tsx#default`),i={title:"YBW Funds Platform",description:"Business Credit & Funding Platform"};function c({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:n().className,children:s.jsx(o,{children:e})})})}},5023:()=>{}};