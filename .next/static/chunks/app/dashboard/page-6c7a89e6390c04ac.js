(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{5745:function(e,s,t){Promise.resolve().then(t.bind(t,6275))},6275:function(e,s,t){"use strict";t.d(s,{DashboardOverview:function(){return i}});var r=t(7437);t(2265);var a=t(6444),n=t(5742);function l(e){let{assessments:s,loading:t}=e;return t?(0,r.jsx)("div",{className:"animate-pulse space-y-3",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"},e))}):s&&0!==s.length?(0,r.jsxs)("div",{className:"space-y-4",children:[s.slice(0,5).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:["Assessment #",s.length-t]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.created_at).toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-lg font-bold text-blue-600",children:e.overall_score}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Score"})]})]},e.id)),s.length>5&&(0,r.jsxs)("button",{className:"w-full text-blue-600 text-sm hover:text-blue-800",children:["View all ",s.length," assessments"]})]}):(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("p",{children:"No assessment history yet"}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"Take your first assessment to see your progress here"})]})}function o(e){let{title:s,value:t,change:a,icon:n}=e;return(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:s}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t}),void 0!==a&&(0,r.jsxs)("p",{className:"text-sm ".concat(a>=0?"text-green-600":"text-red-600"),children:[a>=0?"+":"",a]})]}),n&&(0,r.jsx)("div",{className:"text-2xl",children:n})]})})}function i(){let{userProfile:e,latestAssessment:s,stats:t,loading:i,error:d,refresh:m}=(0,a.r)();return i?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):d?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-red-800 font-semibold",children:"Error Loading Dashboard"}),(0,r.jsx)("p",{className:"text-red-600 mt-2",children:d}),(0,r.jsx)("button",{onClick:m,className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Try Again"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-lg",children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold",children:["Welcome back, ",(null==e?void 0:e.name)||"User","!"]}),(0,r.jsx)("p",{className:"mt-2 opacity-90",children:(null==e?void 0:e.business_name)?"Managing ".concat(e.business_name):"Track your business fundability progress"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(o,{title:"Current Score",value:t.currentScore,change:t.scoreChange,icon:"\uD83D\uDCCA"}),(0,r.jsx)(o,{title:"Total Assessments",value:t.totalAssessments,icon:"\uD83D\uDCCB"}),(0,r.jsx)(o,{title:"Last Assessment",value:t.lastAssessmentDate?new Date(t.lastAssessmentDate).toLocaleDateString():"Never",icon:"\uD83D\uDCC5"}),(0,r.jsx)(o,{title:"Fundability Grade",value:c(t.currentScore),icon:"\uD83C\uDF93"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Fundability Score"}),(0,r.jsx)(n.c,{score:t.currentScore,size:200}),(0,r.jsxs)("div",{className:"mt-4 text-center",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.currentScore}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Grade: ",c(t.currentScore)]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Assessment History"}),(0,r.jsx)(l,{assessments:[],loading:i})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activity"}),(0,r.jsxs)("div",{className:"text-gray-500 text-center py-8",children:[(0,r.jsx)("p",{children:"Activity tracking coming soon..."}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"We'll show your recent assessments, score changes, and recommendations here."})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)("button",{onClick:()=>window.location.href="/assessment",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Take New Assessment"}),(0,r.jsx)("button",{className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"View Recommendations"}),(0,r.jsx)("button",{onClick:()=>window.print(),className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Download Report"})]})]})]})}function c(e){return e>=90?"A - Excellent":e>=80?"B - Good":e>=70?"C - Fair":e>=60?"D - Poor":"F - Very Poor"}},5742:function(e,s,t){"use strict";t.d(s,{c:function(){return a}});var r=t(7437);function a(e){let{score:s,maxScore:t=100,size:a=200}=e,n=Math.min(s/t*100,100),l=2*Math.PI*45;return(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsxs)("div",{className:"relative",style:{width:a,height:a},children:[(0,r.jsxs)("svg",{className:"transform -rotate-90",width:a,height:a,viewBox:"0 0 100 100",children:[(0,r.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"#e5e7eb",strokeWidth:"8",fill:"transparent"}),(0,r.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:s>=80?"#10b981":s>=60?"#f59e0b":s>=40?"#f97316":"#ef4444",strokeWidth:"8",fill:"transparent",strokeDasharray:l,strokeDashoffset:l-n/100*l,strokeLinecap:"round",className:"transition-all duration-1000 ease-in-out"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:s}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["/ ",t]})]})})]})})}t(2265)},6444:function(e,s,t){"use strict";t.d(s,{r:function(){return n}});var r=t(2265),a=t(3655);function n(){let[e,s]=(0,r.useState)({userProfile:null,latestAssessment:null,assessmentHistory:[],scoreTrend:[],loading:!0,error:null,stats:{totalAssessments:0,currentScore:0,scoreChange:0,lastAssessmentDate:null}});(0,r.useEffect)(()=>{t()},[]),(0,r.useEffect)(()=>{let e=()=>{console.log("\uD83D\uDD04 Dashboard refresh triggered, reloading data..."),setTimeout(()=>{t()},500)};return window.addEventListener("dashboardRefresh",e),()=>{window.removeEventListener("dashboardRefresh",e)}},[]),(0,r.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("lastAssessmentResults");if(e)try{let s=JSON.parse(e),r=new Date(s.completedAt);(new Date().getTime()-r.getTime())/6e4<5&&(console.log("\uD83C\uDD95 Recent assessment detected, refreshing dashboard..."),t())}catch(e){console.error("Error parsing recent assessment results:",e)}};return e(),window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);let t=async()=>{try{console.log("\uD83D\uDCCA Loading dashboard data..."),s(e=>({...e,loading:!0,error:null}));let e=null,t=null,{data:r,error:n}=await a.KD.getCurrentUserProfile();if(r&&!n){console.log("✅ Got real user profile:",r),e=r;let{data:s}=await a.WB.getLatestAssessment(e.id);s&&(console.log("✅ Got real assessment data:",s),t=s)}if(!e||!t){let s=localStorage.getItem("lastAssessmentResults");if(s)try{let r=JSON.parse(s);console.log("\uD83D\uDCF1 Using localStorage data:",r),e=e||{id:"demo-user",email:"demo@ybwfunds.com",name:"Demo User",business_name:"Demo Business",fundability_score:r.currentScore,assessment_count:1,last_assessment_date:r.completedAt,created_at:new Date().toISOString(),updated_at:r.completedAt},t={id:"local-assessment",user_id:e.id,overall_score:r.currentScore,category_scores:r.categoryScores,completion_percentage:100,status:"completed",assessment_version:"2.0",created_at:r.completedAt,updated_at:r.completedAt}}catch(e){console.error("Error parsing localStorage data:",e)}}if(!e||!t){console.log("\uD83D\uDD04 Using fallback assessment service...");let s=await a.UI.getLatestAssessment("demo-user");s&&(e=e||{id:"demo-user",email:"demo@ybwfunds.com",name:"Demo User",business_name:"Demo Business",fundability_score:s.overall_score,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},t={...s,updated_at:s.created_at||new Date().toISOString()})}let l=(null==t?void 0:t.overall_score)||0,o=(null==t?void 0:t.created_at)||null;console.log("\uD83D\uDCC8 Final dashboard data:",{currentScore:l,lastAssessmentDate:o}),s({userProfile:e,latestAssessment:t,assessmentHistory:t?[t]:[],scoreTrend:[],loading:!1,error:null,stats:{totalAssessments:1,currentScore:l,scoreChange:0,lastAssessmentDate:o}})}catch(e){console.error("❌ Error loading dashboard data:",e),s(e=>({...e,loading:!1,error:"Unable to load dashboard data"}))}};return{...e,refresh:()=>{console.log("\uD83D\uDD04 Manual refresh triggered"),t()}}}}},function(e){e.O(0,[580,655,971,117,744],function(){return e(e.s=5745)}),_N_E=e.O()}]);