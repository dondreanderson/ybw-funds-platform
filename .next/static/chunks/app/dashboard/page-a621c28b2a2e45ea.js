(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{75745:function(e,t,s){Promise.resolve().then(s.bind(s,73505))},73505:function(e,t,s){"use strict";s.d(t,{DashboardOverview:function(){return B}});var r=s(57437),a=s(2265);let n=(0,s(96580).eI)("https://fzvtzzzsoccptvgihxfl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ6dnR6enpzb2NjcHR2Z2loeGZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExNTAwNjksImV4cCI6MjA2NjcyNjA2OX0.UFY3vSerY963T2cqbgrhstgZfhkgfN5KN7lZUVZ8DLA");class o{static calculateAssessmentScore(e){try{let t=this.groupResponsesByCategory(e),s=[],r=0,a=0,n=0,o=e.length;for(let[e,o]of Object.entries(t)){let t=this.calculateCategoryScore(e,o);s.push(t),r+=t.weightedScore,a+=t.maxScore*t.weight,n+=t.completedCriteria}let i=a>0?r/a*100:0,c=o>0?n/o*100:0,l=this.generateRecommendations(s),d=this.identifyImprovementAreas(s),m=this.identifyStrengths(s);return{overallScore:Math.round(i),maxPossibleScore:Math.round(a),percentageScore:Math.round(100*i)/100,categoryScores:s,completedCriteria:n,totalCriteria:o,completionPercentage:Math.round(100*c)/100,recommendations:l,improvementAreas:d,strengths:m}}catch(e){throw console.error("Error calculating assessment score:",e),e}}static async saveAssessment(e,t){try{let s=t.categoryScores.reduce((e,t)=>(e[t.category]=t.score,e),{}),{data:r,error:a}=await n.from("advanced_fundability_assessments").insert({user_id:e,overall_score:t.overallScore,category_scores:s,completion_percentage:t.completionPercentage,recommendations:t.recommendations,improvement_areas:t.improvementAreas,strengths:t.strengths,status:"completed",assessment_version:"2.0"}).select().single();return!a&&r&&await this.saveScoreHistory(e,r.id,t),{data:r,error:a}}catch(e){return{data:null,error:e}}}static async saveScoreHistory(e,t,s){try{let{data:r}=await n.from("score_history").select("overall_score").eq("user_id",e).order("created_at",{ascending:!1}).limit(1).single(),a=r?s.overallScore-r.overall_score:0,o=s.categoryScores.reduce((e,t)=>(e[t.category]=t.score,e),{}),{data:i,error:c}=await n.from("score_history").insert({user_id:e,assessment_id:t,overall_score:s.overallScore,category_scores:o,assessment_date:new Date().toISOString().split("T")[0],score_change:a}).select().single();return{data:i,error:c}}catch(e){return{data:null,error:e}}}static groupResponsesByCategory(e){return e.reduce((e,t)=>{let s=t.category;return e[s]||(e[s]=[]),e[s].push(t),e},{})}static calculateCategoryScore(e,t){let s=0,r=0,a=0,n=t.length,o=this.CATEGORY_WEIGHTS[e]||1;t.forEach(e=>{let t=e.weightFactor||1;r+=e.pointsPossible*t,null!==e.responseValue&&void 0!==e.responseValue&&(a++,s+=e.pointsEarned*t)});let i=r>0?s/r*100:0,c=s*o;return{category:e,score:Math.round(s),maxScore:Math.round(r),percentage:Math.round(100*i)/100,weight:o,weightedScore:Math.round(c),completedCriteria:a,totalCriteria:n}}static generateRecommendations(e){let t=[];return e.filter(e=>e.percentage<80).sort((e,t)=>e.percentage-t.percentage).slice(0,5).forEach(e=>{t.push(this.getCategoryRecommendation(e.category,e.percentage))}),t}static identifyImprovementAreas(e){return e.filter(e=>e.percentage<70).sort((e,t)=>e.percentage-t.percentage).map(e=>e.category)}static identifyStrengths(e){return e.filter(e=>e.percentage>=85).sort((e,t)=>t.percentage-e.percentage).map(e=>e.category)}static getCategoryRecommendation(e,t){let s=t<50?"immediately":t<70?"soon":"when possible";return({"Business Foundation":"Strengthen your business foundation ".concat(s,". Focus on completing business registration and establishing core business infrastructure."),"Legal Structure":"Improve your legal structure ".concat(s,". Ensure all business licenses and legal documentation are current and complete."),"Banking & Finance":"Enhance your banking relationships ".concat(s,". Consider opening dedicated business accounts and establishing banking relationships."),"Business Credit Profile":"Build your business credit profile ".concat(s,". Apply for business credit accounts and monitor your business credit reports."),"Marketing Presence":"Develop your marketing presence ".concat(s,". Create professional online presence and marketing materials."),"Operational Excellence":"Improve operational systems ".concat(s,". Implement business processes and operational procedures."),Documentation:"Complete business documentation ".concat(s,". Organize and maintain all required business documents."),"Financial Health":"Strengthen financial health ".concat(s,". Focus on improving cash flow and financial management practices.")})[e]||"Improve ".concat(e.toLowerCase()," ").concat(s," to increase your fundability score.")}}o.CATEGORY_WEIGHTS={"Business Foundation":1.2,"Legal Structure":1.1,"Banking & Finance":1.3,"Business Credit Profile":1.4,"Marketing Presence":1,"Operational Excellence":1,Documentation:1.1,"Financial Health":1.2};class i{static async getAssessmentHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{limit:s=10,offset:r=0}=t,{data:a,error:o,count:i}=await n.from("advanced_fundability_assessments").select("*",{count:"exact"}).eq("user_id",e).order("created_at",{ascending:!1}).range(r,r+s-1);return{data:a,error:o,count:i||0}}catch(e){return{data:null,error:e}}}static async getLatestAssessment(e){try{let{data:t,error:s}=await n.from("advanced_fundability_assessments").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(1).single();return{data:t,error:s}}catch(e){return{data:null,error:e}}}static async getScoreTrend(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{let s=new Date;s.setDate(s.getDate()-t);let{data:r,error:a}=await n.from("score_history").select("*").eq("user_id",e).gte("assessment_date",s.toISOString().split("T")[0]).order("assessment_date",{ascending:!0});return{data:r,error:a}}catch(e){return{data:null,error:e}}}static async getAssessmentRecommendations(e){try{let{data:t,error:s}=await n.from("assessment_recommendations").select("*").eq("assessment_id",e).order("priority",{ascending:!1}).order("estimated_impact_points",{ascending:!1});return{data:t,error:s}}catch(e){return{data:null,error:e}}}static async detailedHealthCheck(){let e={connected:!1,tablesAccessible:[],errors:[]};for(let t of["users","user_profiles","advanced_fundability_assessments","score_history","business_profiles"])try{let{error:s}=await n.from(t).select("id").limit(1);s?e.errors.push("".concat(t,": ").concat(s.message)):e.tablesAccessible.push(t)}catch(s){e.errors.push("".concat(t,": ").concat(s))}return e.connected=e.tablesAccessible.length>0,e}}class c{async getLatestAssessment(e){try{console.log("Fetching assessment for user:",e);let t=new Promise((e,t)=>setTimeout(()=>t(Error("Query timeout")),1e4)),s=n.from("advanced_fundability_assessments").select("\n          *,\n          category_performances (*)\n        ").eq("user_id",e).order("created_at",{ascending:!1}).limit(1).single(),{data:r,error:a}=await Promise.race([s,t]);if(a||!r)return console.log("No assessment found or error:",null==a?void 0:a.message),this.getFallbackAssessment(e);return console.log("Assessment found:",r),r}catch(t){return console.error("Error fetching assessment:",t),this.getFallbackAssessment(e)}}async getAssessmentHistory(e){try{console.log("Fetching history for user:",e);let t=await this.getLatestAssessment(e);return t?[t]:[]}catch(e){return console.error("Error fetching history:",e),[]}}async getScoreHistory(e){try{return console.log("Fetching score history for user:",e),this.generateMockHistory(e)}catch(t){return console.error("Error fetching score history:",t),this.generateMockHistory(e)}}async saveAssessment(e,t,s,r){try{console.log("Saving assessment for user:",e);let{data:a,error:o}=await n.from("advanced_fundability_assessments").insert({user_id:e,overall_score:t,category_scores:s,completion_percentage:100,status:"completed",assessment_version:"2.0"}).select().single();if(o)return console.error("Error saving assessment:",o),null;if(r&&r.length>0){let e=r.map(e=>({assessment_id:a.id,category_name:e.categoryName,score:e.score,max_score:e.maxScore,completed_criteria:e.completedCriteria,total_criteria:e.totalCriteria})),{error:t}=await n.from("category_performances").insert(e);t&&console.error("Error saving category performances:",t)}let{error:i}=await n.from("score_history").insert({user_id:e,assessment_id:a.id,overall_score:t,category_scores:s,assessment_date:new Date().toDateString(),score_change:0});return i&&console.error("Error saving score history:",i),console.log("Assessment saved successfully:",a.id),a.id}catch(e){return console.error("Error in saveAssessment:",e),null}}getFallbackAssessment(e){let t={"admin@ybwfunds.com":95,"enterprise@ybwfunds.com":90,"business@ybwfunds.com":85,"demo@ybwfunds.com":75,"startup@ybwfunds.com":65,"lowscore@ybwfunds.com":25}[e]||82;return{id:"fallback-".concat(e),user_id:e,overall_score:t,category_scores:this.generateCategoryScores(t),created_at:new Date().toISOString(),completion_percentage:100,assessment_version:"2.0",status:"completed",category_performances:[{id:"1",category_name:"Business Registration",score:Math.max(30,t-10+20*Math.random()),max_score:100,completed_criteria:18,total_criteria:20},{id:"2",category_name:"Credit Profile",score:Math.max(30,t-5+15*Math.random()),max_score:100,completed_criteria:19,total_criteria:20},{id:"3",category_name:"Financial Documentation",score:Math.max(30,t+10*Math.random()),max_score:100,completed_criteria:17,total_criteria:20},{id:"4",category_name:"Operational Infrastructure",score:Math.max(30,t-15+25*Math.random()),max_score:100,completed_criteria:16,total_criteria:20},{id:"5",category_name:"Online Presence",score:Math.max(30,t-20+30*Math.random()),max_score:100,completed_criteria:15,total_criteria:20},{id:"6",category_name:"Risk & Compliance",score:Math.max(30,t-8+18*Math.random()),max_score:100,completed_criteria:19,total_criteria:20}]}}generateCategoryScores(e){let t={};return["business_registration","credit_profile","financial_documentation","operational_infrastructure","online_presence","risk_compliance"].forEach(s=>{t[s]=Math.max(0,Math.min(100,Math.round(e+(Math.random()-.5)*30)))}),t}generateMockHistory(e){let t=Math.max(20,({"admin@ybwfunds.com":95,"enterprise@ybwfunds.com":90,"business@ybwfunds.com":85,"demo@ybwfunds.com":75,"startup@ybwfunds.com":65,"lowscore@ybwfunds.com":25}[e]||82)-20);return["2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01"].map((e,s)=>({id:"history_".concat(s),overall_score:Math.round(t+4*s),assessment_date:e,category_scores:{}}))}transformToChartData(e){if(console.log("Transforming chart data:",e),!e||!e.category_performances)return{categoryData:[],overallScore:0,metrics:[]};let t=e.category_performances.map(e=>({category:e.category_name,score:Math.round(e.score),fullMark:e.max_score,benchmark:this.getIndustryBenchmark(e.category_name)})),s=e.category_performances.map(e=>({title:e.category_name,value:Math.round(e.score),change:Math.floor(20*Math.random())-10,color:this.getCategoryColor(e.category_name)}));return{categoryData:t,overallScore:e.overall_score,metrics:s}}transformToTrendData(e){return e.map((e,t)=>({date:new Date(e.assessment_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),score:e.overall_score}))}transformToComparisonData(e){return e&&e.category_performances?e.category_performances.map(e=>({category:e.category_name,score:Math.round(e.score),benchmark:this.getIndustryBenchmark(e.category_name),fullMark:e.max_score})):[]}getIndustryBenchmark(e){return({"Business Registration":75,"Credit Profile":80,"Financial Documentation":85,"Operational Infrastructure":78,"Online Presence":72,"Risk & Compliance":80})[e]||75}getCategoryColor(e){return({"Business Registration":"#10b981","Credit Profile":"#3b82f6","Financial Documentation":"#8b5cf6","Operational Infrastructure":"#f59e0b","Online Presence":"#ef4444","Risk & Compliance":"#06b6d4"})[e]||"#6b7280"}}function l(e){let{score:t,maxScore:s=100,size:a=200}=e,n=Math.min(t/s*100,100),o=2*Math.PI*45;return(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsxs)("div",{className:"relative",style:{width:a,height:a},children:[(0,r.jsxs)("svg",{className:"transform -rotate-90",width:a,height:a,viewBox:"0 0 100 100",children:[(0,r.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"#e5e7eb",strokeWidth:"8",fill:"transparent"}),(0,r.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:t>=80?"#10b981":t>=60?"#f59e0b":t>=40?"#f97316":"#ef4444",strokeWidth:"8",fill:"transparent",strokeDasharray:o,strokeDashoffset:o-n/100*o,strokeLinecap:"round",className:"transition-all duration-1000 ease-in-out"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:t}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["/ ",s]})]})})]})})}function d(e){let{title:t,value:s,change:a,icon:n}=e;return(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:t}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s}),void 0!==a&&(0,r.jsxs)("p",{className:"text-sm ".concat(a>=0?"text-green-600":"text-red-600"),children:[a>=0?"+":"",a]})]}),n&&(0,r.jsx)("div",{className:"text-2xl",children:n})]})})}new c;var m=s(47625),u=s(5481),g=s(56940),h=s(97059),x=s(62994),p=s(8147),b=s(23263);function y(e){var t;let{data:s,loading:n}=e,o=a.useMemo(()=>{let e=new Date;return[{date:new Date(e.getTime()-7776e6).toLocaleDateString(),score:45,assessmentType:"Initial"},{date:new Date(e.getTime()-5184e6).toLocaleDateString(),score:52,assessmentType:"Follow-up"},{date:new Date(e.getTime()-2592e6).toLocaleDateString(),score:58,assessmentType:"Progress"},{date:e.toLocaleDateString(),score:s.length>0?s[s.length-1].score:60,assessmentType:"Current"}]},[s]),i=s.length>0?s:o;return n?(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,r.jsx)("div",{className:"h-48 bg-gray-200 rounded"})]})}):(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Score Trend"}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Fundability Score"})]})})]}),(0,r.jsx)("div",{className:"h-64",children:(0,r.jsx)(m.h,{width:"100%",height:"100%",children:(0,r.jsxs)(u.T,{data:i,children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"scoreGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.3}),(0,r.jsx)("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),(0,r.jsx)(g.q,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),(0,r.jsx)(h.K,{dataKey:"date",stroke:"#6B7280",fontSize:12}),(0,r.jsx)(x.B,{domain:[0,100],stroke:"#6B7280",fontSize:12}),(0,r.jsx)(p.u,{contentStyle:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"14px"},formatter:(e,t)=>["".concat(e," points"),"Fundability Score"],labelFormatter:e=>"Date: ".concat(e)}),(0,r.jsx)(b.u,{type:"monotone",dataKey:"score",stroke:"#3B82F6",strokeWidth:3,fill:"url(#scoreGradient)",dot:{fill:"#3B82F6",strokeWidth:2,r:5},activeDot:{r:7,stroke:"#3B82F6",strokeWidth:2}})]})})}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-4 text-center",children:[(0,r.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Best Score"}),(0,r.jsx)("p",{className:"text-lg font-bold text-green-800",children:Math.max(...i.map(e=>e.score))})]}),(0,r.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Current"}),(0,r.jsx)("p",{className:"text-lg font-bold text-blue-800",children:(null===(t=i[i.length-1])||void 0===t?void 0:t.score)||0})]}),(0,r.jsxs)("div",{className:"p-3 bg-purple-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:"Improvement"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-purple-800",children:["+",i.length>1?i[i.length-1].score-i[0].score:0]})]})]})]})}var f=s(76535),v=s(39366),j=s(93019),N=s(8646),w=s(90597);function S(e){let{categoryScores:t,loading:s}=e,n=a.useMemo(()=>Object.entries(Object.keys(t).length>0?t:{"Business Foundation":57,"Banking & Finance":35,"Business Credit Profile":50,"Marketing Presence":67,Documentation:67}).map(e=>{let[t,s]=e;return{category:t.replace(" & ","\n& "),score:s,fullMark:100}}),[t]);return s?(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Category Performance"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Scale: 0-100 points"})]}),(0,r.jsx)("div",{className:"h-80",children:(0,r.jsx)(m.h,{width:"100%",height:"100%",children:(0,r.jsxs)(f.H,{data:n,children:[(0,r.jsx)(v.n,{stroke:"#E5E7EB"}),(0,r.jsx)(j.I,{dataKey:"category",tick:{fill:"#374151",fontSize:12},className:"text-xs"}),(0,r.jsx)(N.S,{angle:90,domain:[0,100],tick:{fill:"#6B7280",fontSize:10}}),(0,r.jsx)(w.F,{name:"Your Score",dataKey:"score",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.2,strokeWidth:2,dot:{fill:"#3B82F6",strokeWidth:1,r:4}})]})})}),(0,r.jsx)("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3",children:n.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.category.replace("\n"," ")}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-12 h-2 bg-gray-200 rounded-full mr-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full ".concat(e.score>=80?"bg-green-500":e.score>=60?"bg-yellow-500":e.score>=40?"bg-orange-500":"bg-red-500"),style:{width:"".concat(e.score,"%")}})}),(0,r.jsx)("span",{className:"text-sm font-bold text-gray-900",children:e.score})]})]},t))})]})}var _=s(77031),F=s(31699),D=s(20407);function C(e){let{userScore:t,industry:s="Technology",loading:n}=e,o=a.useMemo(()=>{let e={Technology:{average:72,top25:85,top10:92},Retail:{average:68,top25:82,top10:89},Manufacturing:{average:71,top25:84,top10:91},Healthcare:{average:74,top25:87,top10:94},"Financial Services":{average:76,top25:88,top10:95},"Professional Services":{average:73,top25:86,top10:93}},r=e[s]||e.Technology;return[{name:"Your Score",value:t,color:"#3B82F6"},{name:"Industry Average",value:r.average,color:"#6B7280"},{name:"Top 25%",value:r.top25,color:"#F59E0B"},{name:"Top 10%",value:r.top10,color:"#10B981"}]},[t,s]);if(n)return(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,r.jsx)("div",{className:"h-48 bg-gray-200 rounded"})]})});let i=a.useMemo(()=>{let e=o[1].value,s=o[2].value;return t>=o[3].value?"Top 10%":t>=s?"Top 25%":t>=e?"Above Average":"Below Average"},[t,o]);return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Industry Benchmark"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[s," Industry"]}),(0,r.jsxs)("p",{className:"text-sm font-medium ".concat(i.includes("Top")?"text-green-600":"Above Average"===i?"text-blue-600":"text-orange-600"),children:["You're in the ",i]})]})]}),(0,r.jsx)("div",{className:"h-48",children:(0,r.jsx)(m.h,{width:"100%",height:"100%",children:(0,r.jsxs)(_.v,{data:o,layout:"horizontal",children:[(0,r.jsx)(g.q,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),(0,r.jsx)(h.K,{type:"number",domain:[0,100],stroke:"#6B7280"}),(0,r.jsx)(x.B,{dataKey:"name",type:"category",stroke:"#6B7280",fontSize:12}),(0,r.jsx)(p.u,{contentStyle:{backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",borderRadius:"8px"},formatter:e=>["".concat(e," points"),"Score"]}),(0,r.jsx)(F.$,{dataKey:"value",radius:[0,4,4,0],children:o.map((e,t)=>(0,r.jsx)(D.b,{fill:e.color},"cell-".concat(t)))})]})})}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Gap to Top 25%"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-blue-800",children:[Math.max(0,o[2].value-t)," points"]})]}),(0,r.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Gap to Top 10%"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-green-800",children:[Math.max(0,o[3].value-t)," points"]})]})]})]})}function k(e){let{categoryScores:t,loading:s}=e,[n,o]=(0,a.useState)(()=>{let e=[];return Object.entries(t).forEach(t=>{let[s,r]=t;if(r<70)switch(s){case"Business Foundation":e.push({id:"bf-1",title:"Obtain EIN from IRS",category:s,priority:"high",impact:15,completed:!1}),e.push({id:"bf-2",title:"Register business with state",category:s,priority:"high",impact:12,completed:!1});break;case"Banking & Finance":e.push({id:"bf-3",title:"Open dedicated business bank account",category:s,priority:"high",impact:18,completed:!1}),e.push({id:"bf-4",title:"Set up business accounting system",category:s,priority:"medium",impact:10,completed:!1});break;case"Business Credit Profile":e.push({id:"bcp-1",title:"Apply for DUNS number",category:s,priority:"high",impact:20,completed:!1}),e.push({id:"bcp-2",title:"Establish trade credit accounts",category:s,priority:"medium",impact:15,completed:!1});break;case"Marketing Presence":e.push({id:"mp-1",title:"Create professional website",category:s,priority:"medium",impact:12,completed:!1}),e.push({id:"mp-2",title:"Set up Google My Business",category:s,priority:"low",impact:8,completed:!1})}}),e.sort((e,t)=>{let s={high:3,medium:2,low:1};return s[t.priority]-s[e.priority]})}),i=e=>{o(t=>t.map(t=>t.id===e?{...t,completed:!t.completed}:t))},c=n.filter(e=>e.completed).length,l=n.reduce((e,t)=>t.completed?e+t.impact:e,0);return s?(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),(0,r.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"h-12 bg-gray-200 rounded"},e))})]})}):(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Improvement Actions"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[c," of ",n.length," completed"]}),(0,r.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["+",l," potential points"]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Overall Progress"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(c/n.length*100),"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-300",style:{width:"".concat(c/n.length*100,"%")}})})]}),(0,r.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:n.map(e=>(0,r.jsxs)("div",{className:"flex items-center p-3 rounded-lg border transition-all ".concat(e.completed?"bg-green-50 border-green-200":"bg-white border-gray-200 hover:bg-gray-50"),children:[(0,r.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>i(e.id),className:"mr-3 h-4 w-4 text-blue-600 rounded focus:ring-blue-500"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm font-medium ".concat(e.completed?"text-gray-500 line-through":"text-gray-900"),children:e.title}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.priority}),(0,r.jsxs)("span",{className:"text-xs text-blue-600 font-medium",children:["+",e.impact,"pt"]})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.category})]})]},e.id))}),0===n.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-4xl mb-2",children:"\uD83C\uDF89"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Great job! No immediate improvements needed."}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Keep maintaining your excellent fundability score!"})]})]})}var A=s(53375);class E{static getScoreGrade(e){return e>=90?{grade:"A",label:"Excellent",color:"#10b981"}:e>=80?{grade:"B",label:"Good",color:"#3b82f6"}:e>=70?{grade:"C",label:"Fair",color:"#f59e0b"}:e>=60?{grade:"D",label:"Poor",color:"#f97316"}:{grade:"F",label:"Very Poor",color:"#ef4444"}}static async generateExecutiveReport(e){let t=new A.ZP("p","mm","a4"),s=t.internal.pageSize.getWidth(),r=t.internal.pageSize.getHeight();return this.addCoverPage(t,e,s,r),t.addPage(),this.addExecutiveSummary(t,e,s),t.addPage(),this.addRecommendations(t,e,s),t.output("blob")}static async generateComprehensiveReport(e){let t=new A.ZP("p","mm","a4"),s=t.internal.pageSize.getWidth(),r=t.internal.pageSize.getHeight();return this.addCoverPage(t,e,s,r),t.addPage(),this.addExecutiveSummary(t,e,s),t.addPage(),this.addCategoryBreakdown(t,e,s),t.addPage(),this.addIndustryBenchmark(t,e,s),t.addPage(),this.addDetailedRecommendations(t,e,s),t.addPage(),this.addActionPlan(t,e,s),t.output("blob")}static addCoverPage(e,t,s,r){let a=this.getScoreGrade(t.assessment.score);e.setFillColor(59,130,246),e.rect(0,0,s,60,"F"),e.setTextColor(255,255,255),e.setFontSize(24),e.setFont("helvetica","bold"),e.text("YBW FUNDS",20,25),e.setFontSize(12),e.setFont("helvetica","normal"),e.text("Business Fundability Platform",20,35),e.setTextColor(0,0,0),e.setFontSize(28),e.setFont("helvetica","bold"),e.text("Fundability Assessment Report",20,85),e.setFontSize(16),e.setFont("helvetica","normal"),e.text("Business: ".concat(t.user.businessName),20,105),e.text("Prepared for: ".concat(t.user.name),20,120),e.text("Date: ".concat(new Date(t.assessment.completedAt).toLocaleDateString()),20,135);let n=s-60;e.setFillColor(240,240,240),e.circle(n,120,25,"F"),e.setTextColor(a.color),e.setFontSize(24),e.setFont("helvetica","bold"),e.text(t.assessment.score.toString(),n-8,125),e.setFontSize(10),e.text("/ 100",n+8,128),e.setTextColor(0,0,0),e.setFontSize(12),e.text("Grade: ".concat(a.grade),n-15,140),e.text(a.label,n-15,150),e.setFontSize(10),e.setTextColor(100,100,100),e.text("Confidential Business Assessment Report",20,r-20),e.text("Generated on ".concat(new Date().toLocaleDateString()),20,r-10)}static addExecutiveSummary(e,t,s){let r=this.getScoreGrade(t.assessment.score);e.setFontSize(20),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("Executive Summary",20,30),e.setFontSize(12),e.setFont("helvetica","normal");let a=["".concat(t.user.businessName," has achieved a fundability score of ").concat(t.assessment.score,"/100,"),"earning a grade of ".concat(r.grade," (").concat(r.label,"). This assessment evaluates your"),"business across multiple critical funding criteria."],n=50;a.forEach(t=>{e.text(t,20,n),n+=8}),n+=10,e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Key Findings",20,n),n+=15,e.setFontSize(11),e.setFont("helvetica","normal");let o=Object.entries(t.assessment.categoryScores).sort((e,t)=>{let[,s]=e,[,r]=t;return r-s});e.text("Strengths:",20,n),n+=8,o.slice(0,2).forEach(t=>{let[s,r]=t;e.text("• ".concat(s,": ").concat(Math.round(r),"/100"),25,n),n+=6}),n+=5,e.text("Areas for Improvement:",20,n),n+=8,o.slice(-2).forEach(t=>{let[s,r]=t;e.text("• ".concat(s,": ").concat(Math.round(r),"/100"),25,n),n+=6}),n+=15,e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Immediate Next Steps",20,n),n+=15,e.setFontSize(11),e.setFont("helvetica","normal"),t.assessment.recommendations.slice(0,3).forEach((t,r)=>{let a=e.splitTextToSize("".concat(r+1,". ").concat(t),s-40);e.text(a,20,n),n+=6*a.length+3})}static addRecommendations(e,t,s){e.setFontSize(20),e.setFont("helvetica","bold"),e.text("Personalized Recommendations",20,30);let r=50;e.setFontSize(11),e.setFont("helvetica","normal"),t.assessment.recommendations.forEach((t,a)=>{r>250&&(e.addPage(),r=30),e.setFont("helvetica","bold"),e.text("".concat(a+1,"."),20,r),e.setFont("helvetica","normal");let n=e.splitTextToSize(t,s-35);e.text(n,28,r),r+=6*n.length+8})}static addCategoryBreakdown(e,t,s){e.setFontSize(20),e.setFont("helvetica","bold"),e.text("Category Performance Breakdown",20,30);let r=55;Object.entries(t.assessment.categoryScores).forEach(t=>{let[a,n]=t;r>240&&(e.addPage(),r=30),e.setFontSize(14),e.setFont("helvetica","bold"),e.text(a,20,r),e.setFontSize(12),e.setFont("helvetica","normal"),e.text("Score: ".concat(Math.round(n),"/100"),s-60,r);let o=r+5;e.setFillColor(230,230,230),e.rect(20,o,100,6,"F");let i=n>=70?[34,197,94]:n>=50?[251,191,36]:[239,68,68];e.setFillColor(i[0],i[1],i[2]),e.rect(20,o,n/100*100,6,"F"),r+=25})}static addIndustryBenchmark(e,t,s){e.setFontSize(20),e.setFont("helvetica","bold"),e.text("Industry Benchmark Comparison",20,30);let r=60;e.setFontSize(12),e.setFont("helvetica","normal"),e.text("Your Score: ".concat(t.assessment.score),20,r),e.text("Industry Average: ".concat(68),20,r+15),e.text("Top 25% Threshold: ".concat(82),20,r+30),e.text("Top 10% Threshold: ".concat(91),20,r+45),r+=70;let a="Below Average";t.assessment.score>=91?a="Top 10%":t.assessment.score>=82?a="Top 25%":t.assessment.score>=68&&(a="Above Average"),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Industry Performance: ".concat(a),20,r)}static addDetailedRecommendations(e,t,s){e.setFontSize(20),e.setFont("helvetica","bold"),e.text("Detailed Action Plan",20,30);let r=55,a=t.assessment.recommendations.slice(0,3),n=t.assessment.recommendations.slice(3,6);e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(220,38,38),e.text("High Priority (Complete within 30 days)",20,r),r+=15,e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),a.forEach((t,a)=>{let n=e.splitTextToSize("".concat(a+1,". ").concat(t),s-40);e.text(n,25,r),r+=6*n.length+8}),n.length>0&&(r+=10,e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(251,146,60),e.text("Medium Priority (Complete within 90 days)",20,r),r+=15,e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),n.forEach((t,a)=>{r>250&&(e.addPage(),r=30);let n=e.splitTextToSize("".concat(a+1,". ").concat(t),s-40);e.text(n,25,r),r+=6*n.length+8}))}static addActionPlan(e,t,s){e.setFontSize(20),e.setFont("helvetica","bold"),e.text("90-Day Action Plan",20,30);let r=55;[{period:"Week 1-2",tasks:["Obtain EIN if needed","Open business bank account","Set up business phone"],impact:"+15-25 points"},{period:"Month 1",tasks:["Apply for DUNS number","Create business website","Establish trade credit"],impact:"+20-30 points"},{period:"Month 2-3",tasks:["Build credit history","Organize financial documents","Obtain business insurance"],impact:"+15-20 points"}].forEach(t=>{r>220&&(e.addPage(),r=30),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(59,130,246),e.text(t.period,20,r),e.setTextColor(34,197,94),e.text("Potential Impact: ".concat(t.impact),s-80,r),r+=12,e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),t.tasks.forEach(t=>{e.text("• ".concat(t),25,r),r+=7}),r+=10})}static async downloadReport(e,t){let s=URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download="".concat(t,".pdf"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}static generateFilename(e){let t=new Date().toISOString().split("T")[0],s=e.user.businessName.replace(/[^a-zA-Z0-9]/g,"_");return"".concat(s,"_Fundability_Report_").concat(t)}}function T(e){let{assessmentData:t,userData:s,onClose:n}=e,[o,i]=(0,a.useState)(!1),[c,l]=(0,a.useState)("executive"),d=async()=>{i(!0);try{let e={user:s,assessment:{score:t.score,categoryScores:t.categoryScores,completedAt:t.completedAt,recommendations:t.recommendations,assessmentType:"comprehensive"},reportType:c},r="executive"===c?await E.generateExecutiveReport(e):await E.generateComprehensiveReport(e),a=E.generateFilename(e);await E.downloadReport(r,a)}catch(e){console.error("Error generating report:",e),alert("Error generating report. Please try again.")}finally{i(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-lg",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"\uD83D\uDCC4 Generate Professional Report"}),(0,r.jsx)("p",{className:"text-blue-100 mt-1",children:"Download your fundability assessment as a professional PDF"})]}),n&&(0,r.jsx)("button",{onClick:n,className:"text-white hover:text-gray-200 text-2xl",children:"\xd7"})]})}),(0,r.jsx)("div",{className:"p-6 border-b bg-blue-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s.businessName}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Assessment completed on ",new Date(t.completedAt).toLocaleDateString()]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:t.score}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Fundability Score"})]})]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Choose Report Type"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{id:"executive",name:"Executive Summary",description:"Concise 3-page overview with key findings and recommendations",pages:"3 pages",features:["Overall score and grade","Key strengths and weaknesses","Top priority recommendations","Next steps"],popular:!0},{id:"comprehensive",name:"Comprehensive Report",description:"Detailed 8-12 page analysis with full breakdown and action plan",pages:"8-12 pages",features:["Complete category breakdown","Industry benchmarking","Detailed recommendations","90-day action plan","Progress tracking framework"],popular:!1}].map(e=>(0,r.jsxs)("div",{className:"relative border-2 rounded-lg p-6 cursor-pointer transition-all ".concat(c===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),onClick:()=>l(e.id),children:[e.popular&&(0,r.jsx)("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Popular"}),(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("input",{type:"radio",checked:c===e.id,onChange:()=>l(e.id),className:"mr-3 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-blue-600",children:e.pages})]})]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Includes:"}),(0,r.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:e.features.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-green-500 mr-2",children:"•"}),e]},t))})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"p-6 bg-gray-50 border-t",children:[(0,r.jsx)("h4",{className:"font-semibold mb-4",children:"Report Preview"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,r.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Business"}),(0,r.jsx)("div",{className:"text-gray-600",children:s.businessName})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Score"}),(0,r.jsxs)("div",{className:"text-gray-600",children:[t.score,"/100"]})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Categories"}),(0,r.jsx)("div",{className:"text-gray-600",children:Object.keys(t.categoryScores).length})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Recommendations"}),(0,r.jsx)("div",{className:"text-gray-600",children:t.recommendations.length})]})]})]}),(0,r.jsxs)("div",{className:"p-6 border-t",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsx)("button",{onClick:d,disabled:o,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generating PDF..."]}):(0,r.jsxs)(r.Fragment,{children:["\uD83D\uDCC4 Download ","executive"===c?"Executive":"Comprehensive"," Report"]})}),n&&(0,r.jsx)("button",{onClick:n,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"Cancel"})]}),(0,r.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h5",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCCB Report Features"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,r.jsx)("li",{children:"• Professional YBW Funds branding"}),(0,r.jsx)("li",{children:"• Secure and confidential formatting"}),(0,r.jsx)("li",{children:"• Ready to share with investors or lenders"}),(0,r.jsx)("li",{children:"• Includes actionable improvement plan"}),(0,r.jsx)("li",{children:"• Industry benchmark comparisons"})]})]})]})]})})}function B(){let{userProfile:e,latestAssessment:t,stats:s,loading:n,error:o,refresh:c}=function(){let[e,t]=(0,a.useState)({userProfile:null,latestAssessment:null,assessmentHistory:[],scoreTrend:[],loading:!0,error:null,stats:{totalAssessments:0,currentScore:0,scoreChange:0,lastAssessmentDate:null}});(0,a.useEffect)(()=>{s()},[]),(0,a.useEffect)(()=>{let e=()=>{console.log("\uD83D\uDD04 Dashboard refresh triggered, reloading data..."),setTimeout(()=>{s()},500)};return window.addEventListener("dashboardRefresh",e),()=>{window.removeEventListener("dashboardRefresh",e)}},[]),(0,a.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("lastAssessmentResults");if(e)try{let t=JSON.parse(e),r=new Date(t.completedAt);(new Date().getTime()-r.getTime())/6e4<5&&(console.log("\uD83C\uDD95 Recent assessment detected, refreshing dashboard..."),s())}catch(e){console.error("Error parsing recent assessment results:",e)}};return e(),window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);let s=async()=>{try{var e;console.log("\uD83D\uDCCA Loading dashboard data..."),t(e=>({...e,loading:!0,error:null}));let s=null,r=null,a=localStorage.getItem("demoUserId");if(a){console.log("\uD83D\uDD0D Loading data for user:",a);try{let{data:e}=await i.getLatestAssessment(a);e&&(console.log("✅ Got real assessment from database:",e),r=e);let t=await fetch("/api/user/profile?userId="+a);if(t.ok){let e=await t.json();e.success&&(s=e.data,console.log("✅ Got real user profile from database"))}}catch(e){console.warn("Database query failed, using localStorage:",e)}}if(!s||!r){let e=localStorage.getItem("lastAssessmentResults");if(e)try{let t=JSON.parse(e);console.log("\uD83D\uDCF1 Using localStorage data as fallback"),s=s||{id:a||"demo-user",email:"demo@ybwfunds.com",name:"Demo User",business_name:"Demo Business",fundability_score:t.currentScore,assessment_count:1,last_assessment_date:t.completedAt,created_at:new Date().toISOString(),updated_at:t.completedAt},r=r||{id:"local-assessment",user_id:s.id,overall_score:t.currentScore,category_scores:t.categoryScores,completion_percentage:100,status:"completed",assessment_version:"2.0",created_at:t.completedAt,updated_at:t.completedAt}}catch(e){console.error("Error parsing localStorage data:",e)}}let n=(null==r?void 0:r.overall_score)||0,o=(null==r?void 0:r.created_at)||null;console.log("\uD83D\uDCC8 Final dashboard data loaded:",{currentScore:n,lastAssessmentDate:o,source:(null==r?void 0:null===(e=r.id)||void 0===e?void 0:e.includes("local"))?"localStorage":"database"}),t({userProfile:s,latestAssessment:r,assessmentHistory:r?[r]:[],scoreTrend:[],loading:!1,error:null,stats:{totalAssessments:1,currentScore:n,scoreChange:0,lastAssessmentDate:o}})}catch(e){console.error("❌ Error loading dashboard data:",e),t(e=>({...e,loading:!1,error:"Unable to load dashboard data"}))}};return{...e,refresh:()=>{console.log("\uD83D\uDD04 Manual refresh triggered"),s()}}}(),m=(null==t?void 0:t.category_scores)||{},[u,g]=(0,a.useState)(!1);return n?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-red-800 font-semibold",children:"Error Loading Dashboard"}),(0,r.jsx)("p",{className:"text-red-600 mt-2",children:o}),(0,r.jsx)("button",{onClick:c,className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Try Again"})]}):(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-lg",children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold",children:["Welcome back, ",(null==e?void 0:e.name)||"User","! \uD83D\uDE80"]}),(0,r.jsx)("p",{className:"mt-2 opacity-90",children:(null==e?void 0:e.business_name)?"Managing ".concat(e.business_name):"Track your business fundability progress"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(d,{title:"Current Score",value:s.currentScore,change:s.scoreChange,icon:"\uD83D\uDCCA"}),(0,r.jsx)(d,{title:"Total Assessments",value:s.totalAssessments,icon:"\uD83D\uDCCB"}),(0,r.jsx)(d,{title:"Last Assessment",value:s.lastAssessmentDate?new Date(s.lastAssessmentDate).toLocaleDateString():"Never",icon:"\uD83D\uDCC5"}),(0,r.jsx)(d,{title:"Fundability Grade",value:P(s.currentScore),icon:"\uD83C\uDF93"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Current Score"}),(0,r.jsx)(l,{score:s.currentScore,size:200}),(0,r.jsxs)("div",{className:"mt-4 text-center",children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.currentScore}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Grade: ",P(s.currentScore)]})]})]}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsx)(y,{data:[],loading:n})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsx)(S,{categoryScores:m,loading:n}),(0,r.jsx)(C,{userScore:s.currentScore,industry:(null==e||e.business_name,"Technology"),loading:n})]}),(0,r.jsx)(k,{categoryScores:m,loading:n}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>window.location.href="/assessment",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCCA"}),"Take New Assessment"]}),(0,r.jsxs)("button",{className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center justify-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCA1"}),"View Recommendations"]}),(0,r.jsxs)("button",{onClick:()=>g(!0),className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium flex items-center justify-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCC4"}),"Generate PDF Report"]})]})]}),u&&(0,r.jsx)(T,{assessmentData:{score:s.currentScore,categoryScores:(null==t?void 0:t.category_scores)||{},recommendations:["Improve business foundation with proper registration and licensing","Enhance credit profile and monitoring systems","Build stronger marketing presence and digital footprint","Organize and update essential business documents","Establish better banking and financial relationships"],completedAt:s.lastAssessmentDate||new Date().toISOString()},userData:{name:(null==e?void 0:e.name)||"User",businessName:(null==e?void 0:e.business_name)||"Business Name",email:(null==e?void 0:e.email)||"user@example.com"},onClose:()=>g(!1)})]})}function P(e){return e>=90?"A - Excellent":e>=80?"B - Good":e>=70?"C - Fair":e>=60?"D - Poor":"F - Very Poor"}}},function(e){e.O(0,[505,497,971,117,744],function(){return e(e.s=75745)}),_N_E=e.O()}]);