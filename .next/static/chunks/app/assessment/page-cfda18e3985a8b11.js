(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{80936:function(e,s,t){Promise.resolve().then(t.bind(t,78762))},99376:function(e,s,t){"use strict";var r=t(35475);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}})},58971:function(e,s,t){"use strict";t.d(s,{u:function(){return i}});var r=t(57437);t(2265);var n=t(99376);function i(e){let{score:s,categoryScores:t,recommendations:i,onClose:a,onSaveAndExit:o}=e,l=(0,n.useRouter)(),c=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":e>=40?"text-orange-600":"text-red-600",d=(()=>{let e=[];return Object.entries(t).forEach(s=>{let[t,r]=s;if(r<70)switch(t){case"Business Foundation":e.push("Strengthen your business foundation with proper registration and licensing");break;case"Banking & Finance":e.push("Improve financial documentation and banking relationships");break;case"Business Credit Profile":e.push("Focus on building business credit history and monitoring");break;case"Marketing Presence":e.push("Enhance your digital presence and marketing materials");break;case"Documentation":e.push("Update and organize essential business documents")}}),e.length>0?e:["Continue maintaining excellent business practices!"]})();return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-lg",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold mb-2",children:"\uD83C\uDF89 Assessment Complete!"}),(0,r.jsx)("p",{className:"text-blue-100",children:"Your comprehensive fundability analysis is ready"})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsxs)("div",{className:"relative inline-flex items-center justify-center w-32 h-32 mb-4",children:[(0,r.jsxs)("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 100 100",children:[(0,r.jsx)("circle",{cx:"50",cy:"50",r:"40",stroke:"#e5e7eb",strokeWidth:"8",fill:"transparent"}),(0,r.jsx)("circle",{cx:"50",cy:"50",r:"40",stroke:s>=80?"#10b981":s>=60?"#f59e0b":"#ef4444",strokeWidth:"8",fill:"transparent",strokeDasharray:"".concat(2.51*s," 251"),strokeLinecap:"round",className:"transition-all duration-1000"})]}),(0,r.jsxs)("div",{className:"absolute flex flex-col items-center",children:[(0,r.jsx)("span",{className:"text-4xl font-bold text-gray-900",children:s}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"out of 100"})]})]}),(0,r.jsx)("h3",{className:"text-2xl font-bold ".concat(c(s)," mb-2"),children:s>=90?"A - Excellent":s>=80?"B - Good":s>=70?"C - Fair":s>=60?"D - Poor":"F - Very Poor"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Your Fundability Score"})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h4",{className:"text-xl font-semibold mb-4",children:"Category Breakdown"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(t).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{className:"font-medium text-gray-900",children:s}),(0,r.jsx)("span",{className:"font-bold ".concat(c(t)),children:Math.round(t)})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat(t>=80?"bg-green-500":t>=60?"bg-yellow-500":t>=40?"bg-orange-500":"bg-red-500"),style:{width:"".concat(t,"%")}})})]},s)})})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h4",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCCB Recommended Actions"}),(0,r.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,r.jsx)("ul",{className:"space-y-2",children:d.map((e,s)=>(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-blue-600 mr-2",children:"•"}),(0,r.jsx)("span",{className:"text-blue-800",children:e})]},s))})})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsx)("button",{onClick:o,className:"flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Save & Go to Dashboard"}),(0,r.jsx)("button",{onClick:()=>window.print(),className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Download Report"}),(0,r.jsx)("button",{onClick:()=>l.push("/assessment"),className:"flex-1 bg-purple-600 text-white py-3 px-6 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Take New Assessment"})]})]})]})})}},78762:function(e,s,t){"use strict";t.d(s,{AssessmentWizard:function(){return m}});var r=t(57437),n=t(2265),i=t(28386);let a=[{id:"has_ein",category:"Business Foundation",question:"Do you have an Employer Identification Number (EIN) for your business?",type:"boolean",required:!0,weight:1.2,isCritical:!0,helpText:"An EIN is essential for business banking, credit, and tax purposes."},{id:"business_structure",category:"Business Foundation",question:"What is your business legal structure?",type:"select",options:["Corporation","LLC","Partnership","Sole Proprietorship"],required:!0,weight:1,isCritical:!0,helpText:"Your business structure affects liability, taxes, and funding opportunities."},{id:"business_license",category:"Business Foundation",question:"Do you have all required business licenses for your industry?",type:"boolean",required:!0,weight:1.1,isCritical:!0,helpText:"Proper licensing demonstrates compliance and legitimacy."},{id:"business_address",category:"Business Foundation",question:"Do you have a dedicated business address (not a PO Box)?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"A physical address builds credibility with lenders and vendors."},{id:"time_in_business",category:"Business Foundation",question:"How many years has your business been operating?",type:"number",required:!0,weight:1,isCritical:!1,helpText:"Longer operating history generally improves funding opportunities."},{id:"business_bank_account",category:"Banking & Finance",question:"Do you have a dedicated business bank account?",type:"boolean",required:!0,weight:1.3,isCritical:!0,helpText:"Separate business banking is crucial for credit building and financial management."},{id:"annual_revenue",category:"Banking & Finance",question:"What is your annual business revenue?",type:"number",required:!0,weight:1.2,isCritical:!1,helpText:"Higher revenue demonstrates business viability and repayment capacity."},{id:"business_credit_card",category:"Banking & Finance",question:"Do you have a business credit card?",type:"boolean",required:!0,weight:1.1,isCritical:!1,helpText:"Business credit cards help build credit history and manage cash flow."},{id:"accounting_system",category:"Banking & Finance",question:"Do you use a professional accounting system (QuickBooks, etc.)?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"Professional accounting demonstrates financial organization and preparedness."},{id:"duns_number",category:"Business Credit Profile",question:"Do you have a DUNS number from Dun & Bradstreet?",type:"boolean",required:!0,weight:1.4,isCritical:!0,helpText:"DUNS numbers are essential for building business credit and accessing financing."},{id:"trade_references",category:"Business Credit Profile",question:"Do you have established trade credit accounts with vendors?",type:"select",options:["Yes, 5+ accounts","Yes, 2-4 accounts","Yes, 1 account","No"],required:!0,weight:1.3,isCritical:!1,helpText:"Trade credit helps establish payment history and creditworthiness."},{id:"business_credit_monitoring",category:"Business Credit Profile",question:"Do you monitor your business credit reports regularly?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"Regular monitoring helps catch errors and track credit building progress."},{id:"personal_credit_score",category:"Business Credit Profile",question:"What is your personal credit score range?",type:"select",options:["750+","700-749","650-699","600-649","550-599","Below 550"],required:!0,weight:1.2,isCritical:!0,helpText:"Personal credit often affects business financing approval and terms."},{id:"business_website",category:"Marketing Presence",question:"Do you have a professional business website?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"A professional website builds credibility and demonstrates business legitimacy."},{id:"google_business_listing",category:"Marketing Presence",question:"Do you have a Google My Business listing?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"Google listings improve visibility and credibility with lenders."},{id:"business_phone",category:"Marketing Presence",question:"Do you have a dedicated business phone number?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"A dedicated business phone adds professionalism and separates business from personal."},{id:"business_plan",category:"Documentation",question:"Do you have a current, comprehensive business plan?",type:"boolean",required:!0,weight:1.1,isCritical:!1,helpText:"Business plans demonstrate strategic thinking and planning to lenders."},{id:"financial_statements",category:"Documentation",question:"Do you have current financial statements (P&L, Balance Sheet)?",type:"boolean",required:!0,weight:1.2,isCritical:!0,helpText:"Current financial statements are required for most business financing."},{id:"tax_returns",category:"Documentation",question:"Are your business tax returns current and filed?",type:"boolean",required:!0,weight:1.2,isCritical:!0,helpText:"Current tax returns prove income and demonstrate compliance."},{id:"insurance_coverage",category:"Documentation",question:"Do you have appropriate business insurance coverage?",type:"boolean",required:!0,weight:1,isCritical:!1,helpText:"Insurance protects your business and demonstrates risk management."}];function o(e){var s;let{question:t,value:n,onChange:a}=e,{setResponse:o}=(0,i.Y)(),l=e=>{o(t.id,e)};return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium text-blue-600 bg-blue-100 rounded-full mb-3",children:t.category}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.question}),t.helpText&&(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:t.helpText})]}),(0,r.jsxs)("div",{className:"space-y-3",children:["boolean"===t.type&&(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:t.id,checked:!0===n,onChange:()=>l(!0),className:"mr-2 text-blue-600"}),(0,r.jsx)("span",{children:"Yes"})]}),(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:t.id,checked:!1===n,onChange:()=>l(!1),className:"mr-2 text-blue-600"}),(0,r.jsx)("span",{children:"No"})]})]}),"select"===t.type&&(0,r.jsxs)("select",{value:n||"",onChange:e=>l(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select an option..."}),null===(s=t.options)||void 0===s?void 0:s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),"number"===t.type&&(0,r.jsx)("input",{type:"number",value:n||"",onChange:e=>l(parseFloat(e.target.value)||0),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter a number..."}),"text"===t.type&&(0,r.jsx)("input",{type:"text",value:n||"",onChange:e=>l(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your response..."})]})]})}function l(e){let{currentStep:s,totalSteps:t,score:n}=e,i=(s+1)/t*100;return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Assessment Progress"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[s+1," of ",t," questions"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:(0,r.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300 ease-in-out",style:{width:"".concat(i,"%")}})}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Current Score: ",(0,r.jsxs)("span",{className:"font-semibold text-blue-600",children:[n,"/100"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[Math.round(i),"% Complete"]})]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ease-in-out ".concat(n>=80?"bg-green-500":n>=60?"bg-yellow-500":n>=40?"bg-orange-500":"bg-red-500"),style:{width:"".concat(n,"%")}})})})]})}function c(e){let{currentStep:s,totalSteps:t,canGoNext:n,isComplete:a,onComplete:o}=e,{nextStep:l,prevStep:c}=(0,i.Y)(),d=s===t-1;return(0,r.jsxs)("div",{className:"flex justify-between items-center mt-8 pt-6 border-t border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>{s>0&&c()},disabled:0===s,className:"px-6 py-3 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"← Previous"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 bg-gray-100 px-4 py-2 rounded-full",children:["Question ",s+1," of ",t]}),d?(0,r.jsx)("button",{onClick:o,disabled:!n,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"Complete Assessment ✓"}):(0,r.jsx)("button",{onClick:()=>{s<t-1&&l()},disabled:!n,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next →"})]})}function d(e){let{currentScore:s,categoryScores:t,completedQuestions:n,totalQuestions:i}=e;return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border sticky top-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Your Score"}),(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsxs)("div",{className:"relative inline-flex items-center justify-center w-24 h-24 mb-3",children:[(0,r.jsxs)("svg",{className:"w-24 h-24 transform -rotate-90",viewBox:"0 0 100 100",children:[(0,r.jsx)("circle",{cx:"50",cy:"50",r:"40",stroke:"#e5e7eb",strokeWidth:"8",fill:"transparent"}),(0,r.jsx)("circle",{cx:"50",cy:"50",r:"40",stroke:s>=80?"#10b981":s>=60?"#f59e0b":"#ef4444",strokeWidth:"8",fill:"transparent",strokeDasharray:"".concat(2.51*s," 251"),strokeLinecap:"round",className:"transition-all duration-500"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:s})})]}),(0,r.jsxs)("div",{className:"inline-block px-3 py-1 rounded-full text-sm font-medium ".concat(s>=80?"text-green-600 bg-green-100":s>=60?"text-yellow-600 bg-yellow-100":s>=40?"text-orange-600 bg-orange-100":"text-red-600 bg-red-100"),children:["Grade: ",s>=90?"A":s>=80?"B":s>=70?"C":s>=60?"D":"F"]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,r.jsx)("span",{children:"Progress"}),(0,r.jsxs)("span",{children:[n,"/",i]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(n/i*100,"%")}})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:"Category Breakdown"}),Object.entries(t).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:s}),(0,r.jsx)("span",{className:"text-gray-900 font-semibold",children:Math.round(t)})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,r.jsx)("div",{className:"h-1.5 rounded-full transition-all duration-300 ".concat(t>=80?"bg-green-500":t>=60?"bg-yellow-500":t>=40?"bg-orange-500":"bg-red-500"),style:{width:"".concat(t,"%")}})})]},s)})]}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h5",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCA1 Quick Tips"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,r.jsx)("li",{children:"• Answer all questions for accurate scoring"}),(0,r.jsx)("li",{children:"• Higher scores improve funding chances"}),(0,r.jsx)("li",{children:"• Focus on critical business foundations"})]})]})]})}var u=t(58971),p=t(99376);function m(){let{state:e,dispatch:s,saveAndUpdateDashboard:t}=(0,i.Y)(),[m,g]=(0,n.useState)(!1),h=(0,p.useRouter)();(0,n.useEffect)(()=>{s({type:"INITIALIZE",questions:a})},[s]);let x=async()=>{g(!0)},b=async()=>{await t(),h.push("/dashboard")};if(m)return(0,r.jsx)(u.u,{score:e.currentScore,categoryScores:e.categoryScores,recommendations:[],onClose:()=>g(!1),onSaveAndExit:b});if(0===e.questions.length)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading assessment questions..."})]})});let y=e.questions[e.currentStep];return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Business Fundability Assessment"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Answer questions about your business to get your comprehensive fundability score"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(l,{currentStep:e.currentStep,totalSteps:e.totalSteps,score:e.currentScore})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsx)(o,{question:y,value:e.responses[y.id],onChange:()=>{}}),(0,r.jsx)(c,{currentStep:e.currentStep,totalSteps:e.totalSteps,canGoNext:void 0!==e.responses[y.id],isComplete:e.isComplete,onComplete:x})]}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsx)(d,{currentScore:e.currentScore,categoryScores:e.categoryScores,completedQuestions:Object.keys(e.responses).length,totalQuestions:e.totalSteps})})]})]})}},28386:function(e,s,t){"use strict";t.d(s,{AssessmentProvider:function(){return l},Y:function(){return c}});var r=t(57437),n=t(2265);let i={currentStep:0,totalSteps:0,responses:{},currentScore:0,categoryScores:{},isComplete:!1,questions:[],loading:!1,error:null};function a(e,s){switch(s.type){case"INITIALIZE":return{...e,questions:s.questions,totalSteps:s.questions.length,currentStep:0,responses:{},currentScore:0,categoryScores:{},isComplete:!1};case"SET_RESPONSE":return{...e,responses:{...e.responses,[s.questionId]:s.value}};case"NEXT_STEP":return{...e,currentStep:Math.min(e.currentStep+1,e.totalSteps-1)};case"PREV_STEP":return{...e,currentStep:Math.max(e.currentStep-1,0)};case"SET_STEP":return{...e,currentStep:Math.max(0,Math.min(s.step,e.totalSteps-1))};case"UPDATE_SCORE":return{...e,currentScore:s.score,categoryScores:s.categoryScores};case"COMPLETE_ASSESSMENT":return{...e,isComplete:!0};case"RESET_ASSESSMENT":return{...i,questions:e.questions,totalSteps:e.questions.length};case"SET_LOADING":return{...e,loading:s.loading};case"SET_ERROR":return{...e,error:s.error};default:return e}}let o=(0,n.createContext)(void 0);function l(e){let{children:s}=e,[t,l]=(0,n.useReducer)(a,i),c=()=>{let e=Object.entries(t.responses).map(e=>{let[s,r]=e,n=t.questions.find(e=>e.id===s);return n?{category:n.category,criterionId:n.id,criterionName:n.question,responseValue:r,responseType:n.type,pointsEarned:function(e,s){switch(e.type){case"boolean":return!0===s?100:0;case"select":return({Excellent:100,"Very Good":85,Good:70,Fair:55,Poor:25,Yes:100,No:0,Corporation:100,LLC:85,Partnership:60,"Sole Proprietorship":40})[s]||0;case"number":if(e.id.includes("revenue")){let e=parseFloat(s)||0;if(e>=1e6)return 100;if(e>=5e5)return 85;if(e>=25e4)return 70;if(e>=1e5)return 55;if(e>=5e4)return 40;return 25}if(e.id.includes("years")||e.id.includes("time")){let e=parseFloat(s)||0;if(e>=5)return 100;if(e>=3)return 80;if(e>=2)return 60;if(e>=1)return 40;return 20}return s>0?75:0;case"text":return s&&s.trim()?80:0;default:return 0}}(n,r),pointsPossible:100,weightFactor:n.weight,isCritical:n.isCritical}:null}).filter(Boolean),s=e.reduce((e,s)=>e+s.pointsEarned,0),r=100*e.length,n={};Object.entries(e.reduce((e,s)=>(e[s.category]||(e[s.category]=[]),e[s.category].push(s),e),{})).forEach(e=>{let[s,t]=e,r=t.reduce((e,s)=>e+s.pointsEarned,0),i=100*t.length;n[s]=i>0?r/i*100:0}),l({type:"UPDATE_SCORE",score:Math.round(r>0?s/r*100:0),categoryScores:n})},d=async()=>{try{l({type:"SET_LOADING",loading:!0}),l({type:"COMPLETE_ASSESSMENT"}),l({type:"SET_LOADING",loading:!1})}catch(e){l({type:"SET_ERROR",error:e instanceof Error?e.message:"Unknown error"}),l({type:"SET_LOADING",loading:!1})}},u=async()=>{try{console.log("\uD83D\uDCBE Saving assessment and updating dashboard..."),l({type:"SET_LOADING",loading:!0});let s={responses:t.responses,currentScore:t.currentScore,categoryScores:t.categoryScores,completedAt:new Date().toISOString(),questions:t.questions};localStorage.setItem("lastAssessmentResults",JSON.stringify(s)),console.log("✅ Saved to localStorage");try{let s=await fetch("/api/fundability/save-assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({responses:t.responses,currentScore:t.currentScore,categoryScores:t.categoryScores})});if(!s.ok)throw Error("HTTP ".concat(s.status,": ").concat(s.statusText));let r=await s.json();if(r.success){if(r.fallback)console.log("⚠️ Fallback save:",r.message);else{var e;console.log("✅ Database save successful:",r.message),(null===(e=r.data)||void 0===e?void 0:e.userId)&&localStorage.setItem("demoUserId",r.data.userId)}}else throw Error(r.error||"Save failed")}catch(e){console.warn("⚠️ API call failed, but localStorage saved:",e)}return window.dispatchEvent(new CustomEvent("dashboardRefresh")),window.dispatchEvent(new StorageEvent("storage",{key:"lastAssessmentResults",newValue:JSON.stringify(s)})),l({type:"SET_LOADING",loading:!1}),!0}catch(e){return console.error("❌ Critical error in save process:",e),l({type:"SET_LOADING",loading:!1}),!1}};return(0,r.jsx)(o.Provider,{value:{state:t,dispatch:l,setResponse:(e,s)=>{l({type:"SET_RESPONSE",questionId:e,value:s}),setTimeout(()=>c(),100)},nextStep:()=>{l({type:"NEXT_STEP"})},prevStep:()=>{l({type:"PREV_STEP"})},goToStep:e=>{l({type:"SET_STEP",step:e})},calculateScore:c,completeAssessment:d,resetAssessment:()=>{l({type:"RESET_ASSESSMENT"})},saveAndUpdateDashboard:u,getReportData:()=>({responses:t.responses,currentScore:t.currentScore,categoryScores:t.categoryScores,questions:t.questions,completedQuestions:Object.keys(t.responses).length})},children:s})}function c(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAssessment must be used within an AssessmentProvider");return e}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=80936)}),_N_E=e.O()}]);