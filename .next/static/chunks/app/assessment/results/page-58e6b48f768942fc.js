(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{8145:function(e,t,s){Promise.resolve().then(s.bind(s,4593))},4593:function(e,t,s){"use strict";s.d(t,{AssessmentResults:function(){return h}});var n=s(7437),r=s(2265),o=s(9376),a=s(8386),i=s(5742),c=s(3375),l=s(4457),d=s.n(l);class u{static async generatePDFReport(e,t){try{let s=this.prepareReportData(e,t),n=this.generateHTMLReport(s),r=document.createElement("div");r.innerHTML=n,r.style.position="absolute",r.style.left="-9999px",r.style.width="8.5in",r.style.background="white",r.style.padding="1in",document.body.appendChild(r);let o=await d()(r,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"});document.body.removeChild(r);let a=new c.ZP("p","mm","a4"),i=210*o.height/o.width,l=i,u=0;for(a.addImage(o.toDataURL("image/png"),"PNG",0,u,210,i),l-=295;l>=0;)u=l-i,a.addPage(),a.addImage(o.toDataURL("image/png"),"PNG",0,u,210,i),l-=295;let p="Fundability_Report_".concat(new Date().toISOString().split("T")[0],".pdf");a.save(p)}catch(s){console.error("Error generating PDF:",s),this.generateSimpleTextReport(e,t)}}static prepareReportData(e,t){var s;return{userInfo:{name:(null==t?void 0:t.name)||"Business Owner",businessName:(null==t?void 0:t.business_name)||"Your Business",email:(null==t?void 0:t.email)||"",assessmentDate:new Date().toLocaleDateString()},scores:{overall:e.currentScore,grade:(s=e.currentScore)>=90?"A - Excellent":s>=80?"B - Good":s>=70?"C - Fair":s>=60?"D - Poor":"F - Very Poor",categoryScores:e.categoryScores},recommendations:(()=>{let t=[];return Object.entries(e.categoryScores).forEach(e=>{let[s,n]=e;if(n<70)switch(s){case"Business Foundation":t.push({category:s,title:"Strengthen Business Foundation",description:"Complete business registration and establish core infrastructure",priority:"High",estimatedImpact:"+15-25 points"});break;case"Banking & Finance":t.push({category:s,title:"Improve Banking Relationships",description:"Open business accounts and establish financial tracking",priority:"Critical",estimatedImpact:"+20-30 points"});break;case"Business Credit Profile":t.push({category:s,title:"Build Business Credit",description:"Establish trade accounts and monitor credit reports",priority:"High",estimatedImpact:"+25-35 points"});break;default:t.push({category:s,title:"Improve ".concat(s),description:"Focus on enhancing your ".concat(s.toLowerCase()," practices"),priority:"Medium",estimatedImpact:"+10-20 points"})}}),t.slice(0,5)})(),responses:e.responses,totalQuestions:e.questions.length}}static generateHTMLReport(e){return'\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Fundability Assessment Report</title>\n        <style>\n          body { \n            font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 40px 20px;\n            background: white;\n          }\n          .header {\n            text-align: center;\n            border-bottom: 3px solid #2563eb;\n            padding-bottom: 30px;\n            margin-bottom: 40px;\n          }\n          .logo {\n            font-size: 28px;\n            font-weight: bold;\n            color: #2563eb;\n            margin-bottom: 10px;\n          }\n          .subtitle {\n            color: #6b7280;\n            font-size: 16px;\n          }\n          .score-section {\n            background: linear-gradient(135deg, #2563eb, #1d4ed8);\n            color: white;\n            padding: 30px;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 30px;\n          }\n          .score-large {\n            font-size: 48px;\n            font-weight: bold;\n            margin: 10px 0;\n          }\n          .grade {\n            font-size: 20px;\n            opacity: 0.9;\n          }\n          .section {\n            margin: 30px 0;\n            padding: 20px;\n            border-radius: 8px;\n            border: 1px solid #e5e7eb;\n          }\n          .section h3 {\n            color: #1f2937;\n            margin-top: 0;\n            border-bottom: 2px solid #e5e7eb;\n            padding-bottom: 10px;\n          }\n          .category-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 10px 0;\n            border-bottom: 1px solid #f3f4f6;\n          }\n          .category-item:last-child {\n            border-bottom: none;\n          }\n          .category-score {\n            font-weight: bold;\n            color: #2563eb;\n          }\n          .recommendation {\n            background: #f9fafb;\n            padding: 15px;\n            margin: 10px 0;\n            border-radius: 6px;\n            border-left: 4px solid #2563eb;\n          }\n          .recommendation-title {\n            font-weight: bold;\n            color: #1f2937;\n          }\n          .recommendation-meta {\n            display: flex;\n            gap: 10px;\n            margin-top: 5px;\n          }\n          .priority {\n            padding: 2px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: bold;\n          }\n          .priority-critical {\n            background: #fee2e2;\n            color: #dc2626;\n          }\n          .priority-high {\n            background: #fed7aa;\n            color: #ea580c;\n          }\n          .priority-medium {\n            background: #dbeafe;\n            color: #2563eb;\n          }\n          .impact {\n            background: #dcfce7;\n            color: #16a34a;\n            padding: 2px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: bold;\n          }\n          .footer {\n            margin-top: 40px;\n            padding-top: 20px;\n            border-top: 1px solid #e5e7eb;\n            text-align: center;\n            color: #6b7280;\n            font-size: 14px;\n          }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <div class="logo">YBW Funds Platform</div>\n          <div class="subtitle">Business Fundability Assessment Report</div>\n        </div>\n\n        <div style="margin-bottom: 30px;">\n          <strong>Business:</strong> '.concat(e.userInfo.businessName,"<br>\n          <strong>Owner:</strong> ").concat(e.userInfo.name,"<br>\n          <strong>Assessment Date:</strong> ").concat(e.userInfo.assessmentDate,"<br>\n          <strong>Questions Completed:</strong> ").concat(e.totalQuestions,'\n        </div>\n\n        <div class="score-section">\n          <h2 style="margin: 0;">Your Fundability Score</h2>\n          <div class="score-large">').concat(e.scores.overall,'</div>\n          <div class="grade">').concat(e.scores.grade,'</div>\n        </div>\n\n        <div class="section">\n          <h3>\uD83D\uDCCA Category Breakdown</h3>\n          ').concat(Object.entries(e.scores.categoryScores).map(e=>{let[t,s]=e;return'\n            <div class="category-item">\n              <span>'.concat(t,'</span>\n              <span class="category-score">').concat(Math.round(s),"</span>\n            </div>\n          ")}).join(""),'\n        </div>\n\n        <div class="section">\n          <h3>\uD83C\uDFAF Personalized Recommendations</h3>\n          ').concat(e.recommendations.length>0?e.recommendations.map(e=>'\n              <div class="recommendation">\n                <div class="recommendation-title">'.concat(e.title,'</div>\n                <div style="color: #6b7280; margin: 5px 0;">').concat(e.description,'</div>\n                <div class="recommendation-meta">\n                  <span class="priority priority-').concat(e.priority.toLowerCase(),'">').concat(e.priority,'</span>\n                  <span class="impact">').concat(e.estimatedImpact,"</span>\n                </div>\n              </div>\n            ")).join(""):'<div style="text-align: center; padding: 20px; color: #6b7280;">\uD83C\uDF1F Excellent work! Your business is in great shape across all categories.</div>','\n        </div>\n\n        <div class="footer">\n          <div>Generated by YBW Funds Platform</div>\n          <div>This report is confidential and intended for business planning purposes.</div>\n        </div>\n      </body>\n      </html>\n    ')}static generateSimpleTextReport(e,t){let s=new Blob(["\nFUNDABILITY ASSESSMENT REPORT\n============================\n\nBusiness: ".concat((null==t?void 0:t.business_name)||"Your Business","\nOwner: ").concat((null==t?void 0:t.name)||"Business Owner","\nDate: ").concat(new Date().toLocaleDateString(),"\n\nOVERALL SCORE: ").concat(e.currentScore,"/100\n\nCATEGORY BREAKDOWN:\n").concat(Object.entries(e.categoryScores).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(Math.round(s))}).join("\n"),"\n\nThis report contains your comprehensive fundability analysis.\nVisit https://ybwfunds.com for detailed recommendations.\n    ")],{type:"text/plain"}),n=window.URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download="Fundability_Report_".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}}var p=s(6444);class m{static getInstance(){return m.instance||(m.instance=new m),m.instance}success(e){this.addToast(e,"success")}error(e){this.addToast(e,"error")}info(e){this.addToast(e,"info")}addToast(e,t){let s=Math.random().toString(36).substr(2,9);this.toasts.push({id:s,message:e,type:t}),this.notifyListeners(),setTimeout(()=>{this.removeToast(s)},3e3)}removeToast(e){this.toasts=this.toasts.filter(t=>t.id!==e),this.notifyListeners()}notifyListeners(){this.listeners.forEach(e=>e(this.toasts))}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}constructor(){this.toasts=[],this.listeners=[]}}let g=m.getInstance();function h(){let{state:e,resetAssessment:t,saveAndUpdateDashboard:s,getReportData:c}=(0,a.Y)(),{userProfile:l}=(0,p.r)(),d=(0,o.useRouter)(),[m,h]=(0,r.useState)(!1),[b,x]=(0,r.useState)(!1),f=e=>e>=90?{grade:"A",label:"Excellent",color:"text-green-600"}:e>=80?{grade:"B",label:"Good",color:"text-blue-600"}:e>=70?{grade:"C",label:"Fair",color:"text-yellow-600"}:e>=60?{grade:"D",label:"Poor",color:"text-orange-600"}:{grade:"F",label:"Very Poor",color:"text-red-600"},y=f(e.currentScore),S=(()=>{let t=[];return Object.entries(e.categoryScores).forEach(e=>{let[s,n]=e;if(n<70)switch(s){case"Business Foundation":t.push({category:s,title:"Strengthen Business Foundation",description:"Complete business registration and establish core infrastructure",priority:"High",estimatedImpact:"+15-25 points"});break;case"Banking & Finance":t.push({category:s,title:"Improve Banking Relationships",description:"Open business accounts and establish financial tracking",priority:"Critical",estimatedImpact:"+20-30 points"});break;case"Business Credit Profile":t.push({category:s,title:"Build Business Credit",description:"Establish trade accounts and monitor credit reports",priority:"High",estimatedImpact:"+25-35 points"});break;default:t.push({category:s,title:"Improve ".concat(s),description:"Focus on enhancing your ".concat(s.toLowerCase()," practices"),priority:"Medium",estimatedImpact:"+10-20 points"})}}),t.slice(0,5)})(),v=async()=>{x(!0),t(),d.push("/dashboard"),await s()?(g.success("Assessment saved! Returning to dashboard..."),setTimeout(()=>{t(),d.push("/dashboard")},1500)):g.error("Error saving assessment. Please try again."),x(!1)},w=async()=>{try{h(!0),c(),await u.generatePDFReport(e,l),g.success("Report downloaded successfully!")}catch(e){console.error("Error generating report:",e),g.error("Error generating report. Please try again.")}finally{h(!1)}};return(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Assessment Complete! \uD83C\uDF89"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Here's your comprehensive fundability analysis and recommendations"})]}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,n.jsxs)("div",{className:"text-center lg:text-left",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your Fundability Score"}),(0,n.jsxs)("div",{className:"flex items-center justify-center lg:justify-start space-x-4 mb-4",children:[(0,n.jsx)("span",{className:"text-6xl font-bold ".concat(y.color),children:e.currentScore}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-xl font-semibold ".concat(y.color),children:["Grade: ",y.grade]}),(0,n.jsx)("p",{className:"text-gray-600",children:y.label})]})]}),(0,n.jsxs)("p",{className:"text-gray-600",children:["Based on ",Object.keys(e.responses).length," questions across ",Object.keys(e.categoryScores).length," categories"]})]}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(i.c,{score:e.currentScore,size:250})})]})}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Category Breakdown"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(e.categoryScores).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900",children:t}),(0,n.jsx)("span",{className:"font-bold ".concat(f(s).color),children:Math.round(s)})]}),(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,n.jsx)("div",{className:"bg-blue-500 h-3 rounded-full transition-all duration-500",style:{width:"".concat(Math.min(s,100),"%")}})}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:f(s).label})]},t)})})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"\uD83C\uDFAF Personalized Recommendations"}),S.length>0?(0,n.jsx)("div",{className:"space-y-4",children:S.map((e,t)=>(0,n.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsx)("h4",{className:"font-semibold text-gray-900",children:e.title}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("Critical"===e.priority?"bg-red-100 text-red-800":"High"===e.priority?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:e.priority}),(0,n.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:e.estimatedImpact})]})]}),(0,n.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Category: ",e.category]})]},t))}):(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF1F"}),(0,n.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Excellent Work!"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Your business is in great shape across all categories. Keep up the excellent work!"})]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"What's Next?"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsx)("button",{onClick:v,disabled:b,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:b?(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Return to Dashboard"}),(0,n.jsx)("button",{onClick:()=>{t(),d.push("/assessment")},className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Take Assessment Again"}),(0,n.jsx)("button",{onClick:w,disabled:m,className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:m?(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generating..."]}):"Download Report"})]}),(0,n.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,n.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCA1 What happens next?"}),(0,n.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,n.jsxs)("li",{children:["• ",(0,n.jsx)("strong",{children:"Return to Dashboard:"})," Save your results and see updated scores"]}),(0,n.jsxs)("li",{children:["• ",(0,n.jsx)("strong",{children:"Take Again:"})," Retake the assessment to improve your score"]}),(0,n.jsxs)("li",{children:["• ",(0,n.jsx)("strong",{children:"Download Report:"})," Get a comprehensive PDF report for your records"]})]})]})]})]})}},5742:function(e,t,s){"use strict";s.d(t,{c:function(){return r}});var n=s(7437);function r(e){let{score:t,maxScore:s=100,size:r=200}=e,o=Math.min(t/s*100,100),a=2*Math.PI*45;return(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsxs)("div",{className:"relative",style:{width:r,height:r},children:[(0,n.jsxs)("svg",{className:"transform -rotate-90",width:r,height:r,viewBox:"0 0 100 100",children:[(0,n.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"#e5e7eb",strokeWidth:"8",fill:"transparent"}),(0,n.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:t>=80?"#10b981":t>=60?"#f59e0b":t>=40?"#f97316":"#ef4444",strokeWidth:"8",fill:"transparent",strokeDasharray:a,strokeDashoffset:a-o/100*a,strokeLinecap:"round",className:"transition-all duration-1000 ease-in-out"})]}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:t}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:["/ ",s]})]})})]})})}s(2265)},8386:function(e,t,s){"use strict";s.d(t,{AssessmentProvider:function(){return l},Y:function(){return d}});var n=s(7437),r=s(3655),o=s(2265);let a={currentStep:0,totalSteps:0,responses:{},currentScore:0,categoryScores:{},isComplete:!1,questions:[],loading:!1,error:null};function i(e,t){switch(t.type){case"INITIALIZE":return{...e,questions:t.questions,totalSteps:t.questions.length,currentStep:0,responses:{},currentScore:0,categoryScores:{},isComplete:!1};case"SET_RESPONSE":return{...e,responses:{...e.responses,[t.questionId]:t.value}};case"NEXT_STEP":return{...e,currentStep:Math.min(e.currentStep+1,e.totalSteps-1)};case"PREV_STEP":return{...e,currentStep:Math.max(e.currentStep-1,0)};case"SET_STEP":return{...e,currentStep:Math.max(0,Math.min(t.step,e.totalSteps-1))};case"UPDATE_SCORE":return{...e,currentScore:t.score,categoryScores:t.categoryScores};case"COMPLETE_ASSESSMENT":return{...e,isComplete:!0};case"RESET_ASSESSMENT":return{...a,questions:e.questions,totalSteps:e.questions.length};case"SET_LOADING":return{...e,loading:t.loading};case"SET_ERROR":return{...e,error:t.error};default:return e}}let c=(0,o.createContext)(void 0);function l(e){let{children:t}=e,[s,l]=(0,o.useReducer)(i,a),d=()=>{let e=Object.entries(s.responses).map(e=>{let[t,n]=e,r=s.questions.find(e=>e.id===t);return r?{category:r.category,criterionId:r.id,criterionName:r.question,responseValue:n,responseType:r.type,pointsEarned:function(e,t){switch(e.type){case"boolean":return!0===t?100:0;case"select":return({Excellent:100,"Very Good":85,Good:70,Fair:55,Poor:25,Yes:100,No:0,Corporation:100,LLC:85,Partnership:60,"Sole Proprietorship":40})[t]||0;case"number":if(e.id.includes("revenue")){let e=parseFloat(t)||0;if(e>=1e6)return 100;if(e>=5e5)return 85;if(e>=25e4)return 70;if(e>=1e5)return 55;if(e>=5e4)return 40;return 25}if(e.id.includes("years")||e.id.includes("time")){let e=parseFloat(t)||0;if(e>=5)return 100;if(e>=3)return 80;if(e>=2)return 60;if(e>=1)return 40;return 20}return t>0?75:0;case"text":return t&&t.trim()?80:0;default:return 0}}(r,n),pointsPossible:100,weightFactor:r.weight,isCritical:r.isCritical}:null}).filter(Boolean),t=e.reduce((e,t)=>e+t.pointsEarned,0),n=100*e.length,r={};Object.entries(e.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{})).forEach(e=>{let[t,s]=e,n=s.reduce((e,t)=>e+t.pointsEarned,0),o=100*s.length;r[t]=o>0?n/o*100:0}),l({type:"UPDATE_SCORE",score:Math.round(n>0?t/n*100:0),categoryScores:r})},u=async()=>{try{l({type:"SET_LOADING",loading:!0}),l({type:"COMPLETE_ASSESSMENT"}),l({type:"SET_LOADING",loading:!1})}catch(e){l({type:"SET_ERROR",error:e instanceof Error?e.message:"Unknown error"}),l({type:"SET_LOADING",loading:!1})}},p=async()=>{try{console.log("\uD83D\uDCBE Saving assessment and updating dashboard..."),l({type:"SET_LOADING",loading:!0});let e={responses:s.responses,currentScore:s.currentScore,categoryScores:s.categoryScores,completedAt:new Date().toISOString(),questions:s.questions};localStorage.setItem("lastAssessmentResults",JSON.stringify(e)),console.log("✅ Saved to localStorage:",e);try{let{data:e}=await r.KD.getCurrentUserProfile();e&&(console.log("\uD83D\uDC64 Updating user profile..."),await r.KD.updateFundabilityScore(e.id,s.currentScore),await r.KD.incrementAssessmentCount(e.id),console.log("✅ Database updated successfully"))}catch(e){console.warn("⚠️ Database update failed, but localStorage saved:",e)}return console.log("\uD83D\uDD14 Triggering dashboard refresh..."),window.dispatchEvent(new CustomEvent("dashboardRefresh")),setTimeout(()=>{window.dispatchEvent(new CustomEvent("dashboardRefresh"))},100),window.dispatchEvent(new StorageEvent("storage",{key:"lastAssessmentResults",newValue:JSON.stringify(e)})),l({type:"SET_LOADING",loading:!1}),!0}catch(e){return console.error("❌ Error saving assessment:",e),l({type:"SET_LOADING",loading:!1}),!1}};return(0,n.jsx)(c.Provider,{value:{state:s,dispatch:l,setResponse:(e,t)=>{l({type:"SET_RESPONSE",questionId:e,value:t}),setTimeout(()=>d(),100)},nextStep:()=>{l({type:"NEXT_STEP"})},prevStep:()=>{l({type:"PREV_STEP"})},goToStep:e=>{l({type:"SET_STEP",step:e})},calculateScore:d,completeAssessment:u,resetAssessment:()=>{l({type:"RESET_ASSESSMENT"})},saveAndUpdateDashboard:p,getReportData:()=>({responses:s.responses,currentScore:s.currentScore,categoryScores:s.categoryScores,questions:s.questions,completedQuestions:Object.keys(s.responses).length})},children:t})}function d(){let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAssessment must be used within an AssessmentProvider");return e}},6444:function(e,t,s){"use strict";s.d(t,{r:function(){return o}});var n=s(2265),r=s(3655);function o(){let[e,t]=(0,n.useState)({userProfile:null,latestAssessment:null,assessmentHistory:[],scoreTrend:[],loading:!0,error:null,stats:{totalAssessments:0,currentScore:0,scoreChange:0,lastAssessmentDate:null}});(0,n.useEffect)(()=>{s()},[]),(0,n.useEffect)(()=>{let e=()=>{console.log("\uD83D\uDD04 Dashboard refresh triggered, reloading data..."),setTimeout(()=>{s()},500)};return window.addEventListener("dashboardRefresh",e),()=>{window.removeEventListener("dashboardRefresh",e)}},[]),(0,n.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("lastAssessmentResults");if(e)try{let t=JSON.parse(e),n=new Date(t.completedAt);(new Date().getTime()-n.getTime())/6e4<5&&(console.log("\uD83C\uDD95 Recent assessment detected, refreshing dashboard..."),s())}catch(e){console.error("Error parsing recent assessment results:",e)}};return e(),window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);let s=async()=>{try{console.log("\uD83D\uDCCA Loading dashboard data..."),t(e=>({...e,loading:!0,error:null}));let e=null,s=null,{data:n,error:o}=await r.KD.getCurrentUserProfile();if(n&&!o){console.log("✅ Got real user profile:",n),e=n;let{data:t}=await r.WB.getLatestAssessment(e.id);t&&(console.log("✅ Got real assessment data:",t),s=t)}if(!e||!s){let t=localStorage.getItem("lastAssessmentResults");if(t)try{let n=JSON.parse(t);console.log("\uD83D\uDCF1 Using localStorage data:",n),e=e||{id:"demo-user",email:"demo@ybwfunds.com",name:"Demo User",business_name:"Demo Business",fundability_score:n.currentScore,assessment_count:1,last_assessment_date:n.completedAt,created_at:new Date().toISOString(),updated_at:n.completedAt},s={id:"local-assessment",user_id:e.id,overall_score:n.currentScore,category_scores:n.categoryScores,completion_percentage:100,status:"completed",assessment_version:"2.0",created_at:n.completedAt,updated_at:n.completedAt}}catch(e){console.error("Error parsing localStorage data:",e)}}if(!e||!s){console.log("\uD83D\uDD04 Using fallback assessment service...");let t=await r.UI.getLatestAssessment("demo-user");t&&(e=e||{id:"demo-user",email:"demo@ybwfunds.com",name:"Demo User",business_name:"Demo Business",fundability_score:t.overall_score,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},s={...t,updated_at:t.created_at||new Date().toISOString()})}let a=(null==s?void 0:s.overall_score)||0,i=(null==s?void 0:s.created_at)||null;console.log("\uD83D\uDCC8 Final dashboard data:",{currentScore:a,lastAssessmentDate:i}),t({userProfile:e,latestAssessment:s,assessmentHistory:s?[s]:[],scoreTrend:[],loading:!1,error:null,stats:{totalAssessments:1,currentScore:a,scoreChange:0,lastAssessmentDate:i}})}catch(e){console.error("❌ Error loading dashboard data:",e),t(e=>({...e,loading:!1,error:"Unable to load dashboard data"}))}};return{...e,refresh:()=>{console.log("\uD83D\uDD04 Manual refresh triggered"),s()}}}}},function(e){e.O(0,[505,337,580,871,655,971,117,744],function(){return e(e.s=8145)}),_N_E=e.O()}]);